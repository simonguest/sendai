import"./modulepreload-polyfill-B5Qt9EMX.js";import{f as Qe,d as B,c as I,Z as V,_ as v,$ as s,A as a,E as g,Y as w,Q as b,B as Xe,a0 as It,r as E,w as W,g as Pe,o as X,a1 as x,a2 as D,F as Q,a3 as te,u as P,P as Dt,U as Tt,n as re,a4 as rt,a5 as Ut,a6 as Mt,a7 as et,a8 as At,a9 as Rt,aa as Ot}from"./@vue-cTl6YTVR.js";import{V as G,a as tt,b as Ne,c as se,d as ie,e as U,f as z,g as J,h as Ie,i as ne,j as Z,k as ye,l as De,m as Te,n as ke,o as oe,p as Bt,q as Ve,r as Ft,s as zt,t as ve,u as Kt,v as jt,w as Be,x as qt,y as Fe,z as ue,A as _e,B as Ht,C as Jt,D as Gt,E as Wt,F as le,G as be,H as $e,I as Yt,J as ht,K as Zt,L as Qt,M as Xt,N as eo,O as to,P as oo}from"./vuetify-1S7o9-SW.js";import{u as ot,a as at,c as ao,b as lo}from"./vue-router-pwNgS7Oi.js";import{v as de}from"./uuid-C6aID195.js";import{m as _t,d as ro}from"./marked-BM9-l-yy.js";import{z as he,H as yt,s as kt,E as no,A as so}from"./@codemirror-Boys7jSw.js";import{b as io}from"./codemirror-BNiQPaZe.js";import{c as m}from"./@lezer-C8D-pblS.js";import{R as uo}from"./@videojs-player-CeoXG8FN.js";import"./video.js-Cp1N-q-1.js";import{O as co}from"./openai-DI9zkULY.js";import{A as mo,R as po,s as vo}from"./@openai-C_C0RElT.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bs6eFhZE.js";import"./w3c-keyname-Vcq4gwWv.js";import"./global-Ao-oLW3a.js";import"./@babel-CCFhuYdL.js";import"./keycode-COWoYAhk.js";import"./safe-json-parse-CN2GHVL4.js";import"./@videojs-B_-B0e53.js";import"./is-function-C0BzV8h3.js";import"./url-toolkit-Dcj1b7Pi.js";import"./videojs-vtt.js-DcT8v0yT.js";import"./m3u8-parser-CpICl_Sf.js";import"./mpd-parser-RiEq4NZi.js";import"./@xmldom-BH8vc9mM.js";import"./mux.js-BqethXN8.js";import"./zod-CfXNNhZx.js";import"./debug-Cg2YkTwG.js";import"./ms-CzQ2E3wO.js";const fo=["en-US","ja-JP","hi-IN","fa-IR"],go="en-US",ce={"en-US":{direction:"ltr",name:"English (US)"},"ja-JP":{direction:"ltr",name:"日本語"},"hi-IN":{direction:"ltr",name:"हिन्दी"},"fa-IR":{direction:"rtl",name:"فارسی"}},bo={"en-US":{light:"Light",dark:"Dark"},"ja-JP":{light:"ライト",dark:"ダーク"},"hi-IN":{light:"हल्का",dark:"गहरा"},"fa-IR":{light:"روشن",dark:"تیره"}},ho={"en-US":{notebooks:"Notebooks",curriculum:"Curriculum",settings:"Settings"},"ja-JP":{notebooks:"ノートブック",curriculum:"カリキュラム",settings:"設定"},"hi-IN":{notebooks:"नोटबुक",curriculum:"पाठ्यक्रम",settings:"सेटिंग्स"},"fa-IR":{notebooks:"دفترچه‌ها",curriculum:"برنامه درسی",settings:"تنظیمات"}},Ue={"en-US":{title:"Notebooks",addNotebook:"Add",blank:"Blank",fromTemplate:"From template",fromFile:"From File",fromUrl:"From URL",delete:"Delete",lastEdited:"Last edited",back:"Back",notebookViewer:"Notebook Viewer",saved:"Saved",saving:"Saving...",saveError:"Save Error",loadingNotebook:"Loading notebook...",failedToLoad:"Failed to load notebook",backToNotebooks:"Back to Notebooks",untitledNotebook:"Untitled Notebook",justNow:"Just now",hoursAgo:"hours ago",hourAgo:"hour ago",daysAgo:"days ago",dayAgo:"day ago",urlDialogTitle:"Import from URL",urlDialogLabel:"Enter notebook URL",urlDialogOpen:"Open",urlDialogCancel:"Close",urlDialogError:"Error",urlDialogErrorMessage:"Failed to fetch notebook from URL",urlDialogInvalidUrl:"Please enter a valid URL (must start with http:// or https://)"},"ja-JP":{title:"ノートブック",addNotebook:"追加",blank:"空白",fromTemplate:"テンプレートから",fromFile:"ファイルから",fromUrl:"URLから",delete:"削除",lastEdited:"最終編集",back:"戻る",notebookViewer:"ノートブックビューア",saved:"保存済み",saving:"保存中...",saveError:"保存エラー",loadingNotebook:"ノートブックを読み込み中...",failedToLoad:"ノートブックの読み込みに失敗しました",backToNotebooks:"ノートブックに戻る",untitledNotebook:"無題のノートブック",justNow:"たった今",hoursAgo:"時間前",hourAgo:"時間前",daysAgo:"日前",dayAgo:"日前",urlDialogTitle:"URLからインポート",urlDialogLabel:"ノートブックのURLを入力",urlDialogOpen:"開く",urlDialogCancel:"閉じる",urlDialogError:"エラー",urlDialogErrorMessage:"URLからノートブックを取得できませんでした",urlDialogInvalidUrl:"有効なURLを入力してください（http://またはhttps://で始まる必要があります）"},"hi-IN":{title:"नोटबुक",addNotebook:"जोड़ें",blank:"खाली",fromTemplate:"टेम्प्लेट से",fromFile:"फ़ाइल से",fromUrl:"URL से",delete:"हटाएं",lastEdited:"अंतिम संपादन",back:"वापस",notebookViewer:"नोटबुक व्यूअर",saved:"सहेजा गया",saving:"सहेज रहे हैं...",saveError:"सहेजने में त्रुटि",loadingNotebook:"नोटबुक लोड हो रहा है...",failedToLoad:"नोटबुक लोड करने में विफल",backToNotebooks:"नोटबुक पर वापस जाएं",untitledNotebook:"बिना शीर्षक नोटबुक",justNow:"अभी",hoursAgo:"घंटे पहले",hourAgo:"घंटा पहले",daysAgo:"दिन पहले",dayAgo:"दिन पहले",urlDialogTitle:"URL से आयात करें",urlDialogLabel:"नोटबुक URL दर्ज करें",urlDialogOpen:"खोलें",urlDialogCancel:"बंद करें",urlDialogError:"त्रुटि",urlDialogErrorMessage:"URL से नोटबुक प्राप्त करने में विफल",urlDialogInvalidUrl:"कृपया एक वैध URL दर्ज करें (http:// या https:// से शुरू होना चाहिए)"},"fa-IR":{title:"دفترچه‌ها",addNotebook:"افزودن",blank:"خالی",fromTemplate:"از قالب",fromFile:"از فایل",fromUrl:"از URL",delete:"حذف",lastEdited:"آخرین ویرایش",back:"بازگشت",notebookViewer:"نمایشگر دفترچه",saved:"ذخیره شد",saving:"در حال ذخیره...",saveError:"خطا در ذخیره",loadingNotebook:"در حال بارگذاری دفترچه...",failedToLoad:"بارگذاری دفترچه ناموفق بود",backToNotebooks:"بازگشت به دفترچه‌ها",untitledNotebook:"دفترچه بدون عنوان",justNow:"همین الان",hoursAgo:"ساعت پیش",hourAgo:"ساعت پیش",daysAgo:"روز پیش",dayAgo:"روز پیش",urlDialogTitle:"وارد کردن از URL",urlDialogLabel:"URL دفترچه را وارد کنید",urlDialogOpen:"باز کردن",urlDialogCancel:"بستن",urlDialogError:"خطا",urlDialogErrorMessage:"دریافت دفترچه از URL ناموفق بود",urlDialogInvalidUrl:"لطفاً یک URL معتبر وارد کنید (باید با http:// یا https:// شروع شود)"}},wt={"en-US":{title:"Settings",appearance:"Appearance",language:"Language",about:"About",theme:"Theme",version:"Version",appName:"K12 Notebook - Web Shell",aiProviders:"AI Providers",add:"Add",providerName:"Provider Name",providerUrl:"Provider URL",apiKey:"API Key",models:"Models",refreshModels:"Refresh Models",defaultProvider:"Default Provider",removeProvider:"Remove Provider",editProvider:"Edit Provider",saveProvider:"Save Provider",cancelEdit:"Cancel",noProviders:"No AI providers configured",loadingModels:"Loading models...",errorLoadingModels:"Error loading models",invalidUrl:"Invalid URL format",providerNameRequired:"Provider name is required",apiKeyRequired:"API key is required",urlRequired:"URL is required",setDefault:"Set Default"},"ja-JP":{title:"設定",appearance:"外観",language:"言語",about:"について",theme:"テーマ",version:"バージョン",appName:"K12ノートブック - ウェブシェル",aiProviders:"AIプロバイダー",add:"追加",providerName:"プロバイダー名",providerUrl:"プロバイダーURL",apiKey:"APIキー",models:"モデル",refreshModels:"モデルを更新",defaultProvider:"デフォルトプロバイダー",removeProvider:"プロバイダーを削除",editProvider:"プロバイダーを編集",saveProvider:"プロバイダーを保存",cancelEdit:"キャンセル",noProviders:"AIプロバイダーが設定されていません",loadingModels:"モデルを読み込み中...",errorLoadingModels:"モデルの読み込みエラー",invalidUrl:"無効なURL形式",providerNameRequired:"プロバイダー名は必須です",apiKeyRequired:"APIキーは必須です",urlRequired:"URLは必須です",setDefault:"デフォルトに設定"},"hi-IN":{title:"सेटिंग्स",appearance:"दिखावट",language:"भाषा",about:"के बारे में",theme:"थीम",version:"संस्करण",appName:"K12 नोटबुक - वेब शेल",aiProviders:"AI प्रदाता",add:"जोड़ें",providerName:"प्रदाता का नाम",providerUrl:"प्रदाता URL",apiKey:"API की",models:"मॉडल",refreshModels:"मॉडल रीफ्रेश करें",defaultProvider:"डिफ़ॉल्ट प्रदाता",removeProvider:"प्रदाता हटाएं",editProvider:"प्रदाता संपादित करें",saveProvider:"प्रदाता सहेजें",cancelEdit:"रद्द करें",noProviders:"कोई AI प्रदाता कॉन्फ़िगर नहीं",loadingModels:"मॉडल लोड हो रहे हैं...",errorLoadingModels:"मॉडल लोड करने में त्रुटि",invalidUrl:"अमान्य URL प्रारूप",providerNameRequired:"प्रदाता का नाम आवश्यक है",apiKeyRequired:"API की आवश्यक है",urlRequired:"URL आवश्यक है",setDefault:"डिफ़ॉल्ट सेट करें"},"fa-IR":{title:"تنظیمات",appearance:"ظاهر",language:"زبان",about:"درباره",theme:"تم",version:"نسخه",appName:"دفترچه K12 - پوسته وب",aiProviders:"ارائه‌دهندگان هوش مصنوعی",add:"افزودن",providerName:"نام ارائه‌دهنده",providerUrl:"آدرس ارائه‌دهنده",apiKey:"کلید API",models:"مدل‌ها",refreshModels:"بروزرسانی مدل‌ها",defaultProvider:"ارائه‌دهنده پیش‌فرض",removeProvider:"حذف ارائه‌دهنده",editProvider:"ویرایش ارائه‌دهنده",saveProvider:"ذخیره ارائه‌دهنده",cancelEdit:"لغو",noProviders:"هیچ ارائه‌دهنده هوش مصنوعی پیکربندی نشده",loadingModels:"در حال بارگذاری مدل‌ها...",errorLoadingModels:"خطا در بارگذاری مدل‌ها",invalidUrl:"فرمت آدرس نامعتبر",providerNameRequired:"نام ارائه‌دهنده الزامی است",apiKeyRequired:"کلید API الزامی است",urlRequired:"آدرس الزامی است",setDefault:"تنظیم به عنوان پیش‌فرض"}},Me={"en-US":{notebookStarting:"The notebook is starting up...",notebookStartError:"The notebook could not be started because of an error:",inputDialogTitle:"Enter Input",inputDialogLabel:"Input",inputDialogCancel:"Cancel",inputDialogSubmit:"Submit",globalsDialogTitle:"Global Variables",addVariable:"Add",variableName:"Variable Name",defaultValue:"Default Value",addLocale:"Add Locale",deleteVariable:"Delete Variable",save:"Save",cancel:"Cancel",languageOverride:"Language Override",noLanguageOverride:"None"},"ja-JP":{notebookStarting:"ノートブックを起動中...",notebookStartError:"エラーのためノートブックを起動できませんでした:",inputDialogTitle:"入力してください",inputDialogLabel:"入力",inputDialogCancel:"キャンセル",inputDialogSubmit:"送信",globalsDialogTitle:"グローバル変数",addVariable:"変数を追加",variableName:"変数名",defaultValue:"デフォルト値",addLocale:"ロケールを追加",deleteVariable:"変数を削除",save:"保存",cancel:"キャンセル",languageOverride:"言語オーバーライド",noLanguageOverride:"なし"},"hi-IN":{notebookStarting:"नोटबुक शुरू हो रहा है...",notebookStartError:"त्रुटि के कारण नोटबुक शुरू नहीं हो सका:",inputDialogTitle:"इनपुट दर्ज करें",inputDialogLabel:"इनपुट",inputDialogCancel:"रद्द करें",inputDialogSubmit:"जमा करें",globalsDialogTitle:"ग्लोबल वेरिएबल्स",addVariable:"वेरिएबल जोड़ें",variableName:"वेरिएबल नाम",defaultValue:"डिफ़ॉल्ट मान",addLocale:"लोकेल जोड़ें",deleteVariable:"वेरिएबल हटाएं",save:"सेव करें",cancel:"रद्द करें",languageOverride:"भाषा ओवरराइड",noLanguageOverride:"कोई नहीं"},"fa-IR":{notebookStarting:"دفترچه در حال راه‌اندازی است...",notebookStartError:"دفترچه به دلیل خطا راه‌اندازی نشد:",inputDialogTitle:"ورودی را وارد کنید",inputDialogLabel:"ورودی",inputDialogCancel:"لغو",inputDialogSubmit:"ارسال",globalsDialogTitle:"متغیرهای سراسری",addVariable:"افزودن متغیر",variableName:"نام متغیر",defaultValue:"مقدار پیش‌فرض",addLocale:"افزودن زبان",deleteVariable:"حذف متغیر",save:"ذخیره",cancel:"لغو",languageOverride:"بازنویسی زبان",noLanguageOverride:"هیچ"}},_o=["light","dark"],yo="dark";class Ge{static async fetchModels(e,t){try{const o=`${e}/models`,n=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return(await n.json()).data||[]}catch(o){throw console.error("Error fetching models:",o),o}}static validateUrl(e){try{return new URL(e),!0}catch{return!1}}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}}const ko=()=>{const l=localStorage.getItem("aiProviders");return l?JSON.parse(l):[]},we=l=>{localStorage.setItem("aiProviders",JSON.stringify(l))},T=Qe({theme:localStorage.getItem("theme")||yo,locale:localStorage.getItem("locale")||go,aiProviders:ko(),setTheme(l){this.theme=l,localStorage.setItem("theme",l)},setLocale(l){this.locale=l,localStorage.setItem("locale",l)},addProvider(l){const e={...l,id:Ge.generateId(),isDefault:this.aiProviders.length===0};this.aiProviders.push(e),we(this.aiProviders)},removeProvider(l){const e=this.aiProviders.findIndex(o=>o.id===l);if(e===-1)return;const t=this.aiProviders[e].isDefault;this.aiProviders.splice(e,1),t&&this.aiProviders.length>0&&(this.aiProviders[0].isDefault=!0),we(this.aiProviders)},updateProvider(l,e){const t=this.aiProviders.find(o=>o.id===l);t&&(Object.assign(t,e),we(this.aiProviders))},setDefaultProvider(l){this.aiProviders.forEach(t=>t.isDefault=!1);const e=this.aiProviders.find(t=>t.id===l);e&&(e.isDefault=!0,we(this.aiProviders))},getDefaultProvider(){return this.aiProviders.find(l=>l.isDefault)}}),wo={class:"d-flex justify-end mb-2"},xo={class:"d-flex align-center"},Co={class:"flex-grow-1"},So={class:"text-h6 mb-1"},Vo={class:"text-caption text-medium-emphasis mb-0"},$o=B({__name:"NotebookCard",props:{notebook:{}},emits:["delete"],setup(l,{emit:e}){const t=l,o=e,n=ot(),i=I(()=>Ue[T.locale]),u=d=>{const _=Math.floor((new Date().getTime()-d.getTime())/(1e3*60*60));if(_<1)return i.value.justNow;if(_<24){const C=_===1?i.value.hourAgo:i.value.hoursAgo;return`${_} ${C}`}else{const C=Math.floor(_/24),$=C===1?i.value.dayAgo:i.value.daysAgo;return`${C} ${$}`}},r=()=>{n.push(`/notebooks/${t.notebook.id}`)},p=()=>{o("delete",t.notebook.id)};return(d,h)=>(v(),V(J,{class:"notebook-card",hover:"",onClick:r},{default:s(()=>[a(G,{class:"pb-2"},{default:s(()=>[g("div",wo,[a(tt,null,{activator:s(({props:_})=>[a(U,Xe({icon:"mdi-dots-vertical",variant:"text",size:"small"},_,{onClick:h[0]||(h[0]=It(()=>{},["stop"]))}),null,16)]),default:s(()=>[a(Ne,null,{default:s(()=>[a(se,{onClick:p},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(i.value.delete),1)]),_:1})]),_:1})]),_:1})]),_:1})]),g("div",xo,[a(z,{icon:"mdi-notebook-outline",size:"large",color:"primary",class:"me-3"}),g("div",Co,[g("h3",So,b(d.notebook.title),1),g("p",Vo,b(i.value.lastEdited)+": "+b(u(d.notebook.lastModified||d.notebook.created)),1)])])]),_:1})]),_:1}))}}),H=(l,e)=>{const t=l.__vccOpts||l;for(const[o,n]of e)t[o]=n;return t},Eo=H($o,[["__scopeId","data-v-3a1233ae"]]),Lo="NotebookDB",Y="notebooks",Po=2,Ae=async()=>new Promise((l,e)=>{const t=indexedDB.open(Lo,Po);t.onerror=()=>e(t.error),t.onsuccess=()=>l(t.result),t.onupgradeneeded=o=>{const n=t.result;if(n.objectStoreNames.contains(Y)){if(o.oldVersion<2){const i=t.transaction;if(i){const u=i.objectStore(Y);u.openCursor().onsuccess=r=>{const p=r.target.result;if(p){const d=p.value;d.created||(d.created=d.lastModified||Date.now(),p.update(d)),p.continue()}}}}}else{const i=n.createObjectStore(Y,{keyPath:"id"});i.createIndex("lastModified","lastModified"),i.createIndex("created","created")}}}),Re=async(l,e)=>{const t=await Ae();if(!t.objectStoreNames.contains(Y))throw new Error("Database not properly initialized");return new Promise((o,n)=>{try{const i=t.transaction(Y,"readwrite"),u=i.objectStore(Y),r=u.get(l);r.onsuccess=()=>{const p=r.result,d=Date.now(),h={id:l,notebook:e,lastModified:d,created:(p==null?void 0:p.created)||d},_=u.put(h);_.onsuccess=()=>o(),_.onerror=()=>n(_.error)},r.onerror=()=>n(r.error),i.oncomplete=()=>t.close()}catch(i){n(i)}})},xt=async l=>{const e=await Ae();if(!e.objectStoreNames.contains(Y))throw new Error("Database not properly initialized");return new Promise((t,o)=>{try{const n=e.transaction(Y,"readonly"),u=n.objectStore(Y).get(l);u.onsuccess=()=>{const r=u.result;if(!r){o(new Error("Notebook not found"));return}t(r.notebook)},u.onerror=()=>o(u.error),n.oncomplete=()=>e.close()}catch(n){o(n)}})},xe=async()=>{const l=await Ae();if(!l.objectStoreNames.contains(Y))throw new Error("Database not properly initialized");return new Promise((e,t)=>{try{const o=l.transaction(Y,"readonly"),i=o.objectStore(Y).getAll();i.onsuccess=()=>{const r=i.result.map(p=>{var d;return{id:p.id,title:((d=p.notebook.metadata)==null?void 0:d.title)||"Untitled Notebook",lastModified:new Date(p.lastModified),created:new Date(p.created)}});r.sort((p,d)=>d.created.getTime()-p.created.getTime()),e(r)},i.onerror=()=>t(i.error),o.oncomplete=()=>l.close()}catch(o){t(o)}})},No=async l=>{const e=await Ae();if(!e.objectStoreNames.contains(Y))throw new Error("Database not properly initialized");return new Promise((t,o)=>{try{const n=e.transaction(Y,"readwrite");n.objectStore(Y).delete(l),n.oncomplete=()=>t(),n.onerror=()=>o(n.error)}catch(n){o(n)}})},Io=async()=>{try{const l=await fetch("./templates/blank.ipynb");if(!l.ok)throw new Error(`Failed to load blank notebook template: ${l.statusText}`);const e=await l.json();return e.cells.forEach(t=>{t.id||(t.id=de())}),e}catch(l){throw new Error(`Failed to load blank notebook template: ${l instanceof Error?l.message:String(l)}`)}},Do=async l=>new Promise((e,t)=>{const o=new FileReader;o.onload=async n=>{var i;try{const u=(i=n.target)==null?void 0:i.result,r=JSON.parse(u);if(!r.cells||!Array.isArray(r.cells))throw new Error("Invalid notebook format: missing or invalid cells array");r.metadata||(r.metadata={}),r.nbformat||(r.nbformat=4),r.nbformat_minor||(r.nbformat_minor=2),r.cells.forEach(d=>{d.id||(d.id=de()),d.metadata||(d.metadata={}),d.source||(d.source=[])}),r.metadata.title||(r.metadata.title=l.name.replace(".ipynb","")||"Imported Notebook");const p=de();await Re(p,r),e(p)}catch(u){t(new Error(`Failed to parse notebook file: ${u instanceof Error?u.message:String(u)}`))}},o.onerror=()=>{t(new Error("Failed to read the selected file"))},o.readAsText(l)}),To=l=>{try{const e=new URL(l);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}},Uo=async l=>{if(!To(l))throw new Error("Please enter a valid URL (must start with http:// or https://)");try{const e=await fetch(l);if(!e.ok)throw new Error(`Failed to fetch notebook: ${e.status} ${e.statusText}`);const t=await e.text(),o=JSON.parse(t);if(!o.cells||!Array.isArray(o.cells))throw new Error("Invalid notebook format: missing or invalid cells array");if(o.metadata||(o.metadata={}),o.nbformat||(o.nbformat=4),o.nbformat_minor||(o.nbformat_minor=2),o.cells.forEach(i=>{i.id||(i.id=de()),i.metadata||(i.metadata={}),i.source||(i.source=[])}),!o.metadata.title){const u=new URL(l).pathname.split("/").pop()||"imported-notebook.ipynb";o.metadata.title=u.replace(".ipynb","")||"Imported Notebook"}const n=de();return await Re(n,o),n}catch(e){throw e instanceof Error?e:new Error(`Failed to import notebook from URL: ${String(e)}`)}},Mo=B({__name:"UrlInputDialog",props:{show:{type:Boolean}},emits:["cancel","submit"],setup(l,{emit:e}){const t=l,o=e,n=I(()=>Ue[T.locale]),i=E(""),u=E(),r=E(""),p=()=>{const _=i.value.trim();if(!_){r.value=n.value.urlDialogInvalidUrl;return}try{const C=new URL(_);if(C.protocol!=="http:"&&C.protocol!=="https:"){r.value=n.value.urlDialogInvalidUrl;return}}catch{r.value=n.value.urlDialogInvalidUrl;return}r.value="",o("submit",_),i.value=""},d=()=>{o("cancel"),i.value="",r.value=""};W(()=>t.show,async _=>{var C;_&&(await Pe(),(C=u.value)==null||C.focus(),r.value="")});const h=_=>{_.key==="Enter"?(_.preventDefault(),p()):_.key==="Escape"&&(_.preventDefault(),d())};return W(i,()=>{r.value&&(r.value="")}),(_,C)=>(v(),V(Ie,{"model-value":_.show,"max-width":"500px",persistent:"",onKeydown:h},{default:s(()=>[a(J,null,{default:s(()=>[a(ne,null,{default:s(()=>[w(b(n.value.urlDialogTitle),1)]),_:1}),a(G,null,{default:s(()=>[a(Z,{ref_key:"inputFieldRef",ref:u,modelValue:i.value,"onUpdate:modelValue":C[0]||(C[0]=$=>i.value=$),label:n.value.urlDialogLabel,"error-messages":r.value,variant:"outlined",density:"compact",placeholder:"https://example.com/notebook.ipynb",onKeydown:h},null,8,["modelValue","label","error-messages"])]),_:1}),a(ye,null,{default:s(()=>[a(De),a(U,{color:"grey",variant:"text",onClick:d},{default:s(()=>[w(b(n.value.urlDialogCancel),1)]),_:1}),a(U,{color:"primary",variant:"text",onClick:p},{default:s(()=>[w(b(n.value.urlDialogOpen),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),Ao={class:"notebook-index"},Ro={class:"d-flex align-center mb-6 header-container"},Oo={class:"text-h4 notebook-title flex-grow-1"},Bo={key:0,class:"text-center mt-8"},Fo=B({__name:"NotebookIndex",setup(l){const e=I(()=>Ue[T.locale]),t=I(()=>ce[T.locale].direction==="rtl"),o=E([]),n=E(!1),i=E({show:!1,title:"",message:""});X(async()=>{try{const $=await xe();o.value=$}catch($){console.error("Failed to load notebooks:",$)}});const u=async $=>{try{await No($);const L=o.value.findIndex(k=>k.id===$);L>-1&&o.value.splice(L,1),console.log("Notebook deleted successfully:",$)}catch(L){console.error("Failed to delete notebook:",L)}},r=async()=>{try{console.log("Create blank notebook");const $=await Io(),L=de();await Re(L,$),console.log("Created notebook with id:",L);const k=await xe();o.value=k}catch($){console.error("Failed to create blank notebook:",$)}},p=async()=>{try{const $=document.createElement("input");$.type="file",$.accept=".ipynb",$.style.display="none",$.onchange=async L=>{var A;const k=(A=L.target.files)==null?void 0:A[0];if(!k){console.log("No file selected");return}try{const R=await Do(k);console.log("Notebook imported successfully:",R);const j=await xe();o.value=j}catch(R){console.error("Failed to import notebook:",R),alert(`Failed to import notebook: ${R instanceof Error?R.message:"Unknown error"}`)}},document.body.appendChild($),$.click(),document.body.removeChild($)}catch($){console.error("Failed to import notebook:",$),alert("Failed to import notebook. Please try again.")}},d=()=>{n.value=!0},h=async $=>{n.value=!1;try{console.log("Importing notebook from URL:",$);const L=await Uo($);console.log("Notebook imported successfully:",L);const k=await xe();o.value=k}catch(L){console.error("Failed to import notebook from URL:",L),setTimeout(()=>{i.value={show:!0,title:e.value.urlDialogError,message:L instanceof Error?L.message:e.value.urlDialogErrorMessage}},150)}},_=()=>{n.value=!1},C=()=>{i.value.show=!1};return($,L)=>(v(),x("div",Ao,[a(Te,{fluid:"",class:"pa-4"},{default:s(()=>[g("div",Ro,[g("h1",Oo,b(e.value.title),1),a(tt,null,{activator:s(({props:k})=>[a(U,Xe({color:"primary"},k,{"prepend-icon":t.value?void 0:"mdi-plus","append-icon":t.value?"mdi-plus":void 0}),{default:s(()=>[w(b(e.value.addNotebook),1)]),_:2},1040,["prepend-icon","append-icon"])]),default:s(()=>[a(Ne,null,{default:s(()=>[a(se,{onClick:r},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(e.value.blank),1)]),_:1})]),_:1}),a(se,{onClick:p},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(e.value.fromFile),1)]),_:1})]),_:1}),a(se,{onClick:d},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(e.value.fromUrl),1)]),_:1})]),_:1})]),_:1})]),_:1})]),a(ke,null,{default:s(()=>[(v(!0),x(Q,null,te(o.value,k=>(v(),V(oe,{key:k.id,cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[a(Eo,{notebook:k,onDelete:u},null,8,["notebook"])]),_:2},1024))),128))]),_:1}),o.value.length===0?(v(),x("div",Bo,[a(z,{icon:"mdi-notebook-outline",size:"64",color:"grey"}),L[1]||(L[1]=g("p",{class:"text-h6 mt-4 text-medium-emphasis"},"No notebooks yet",-1)),L[2]||(L[2]=g("p",{class:"text-body-2 text-medium-emphasis"},"Create your first notebook to get started",-1))])):D("",!0)]),_:1}),a(Mo,{show:n.value,onSubmit:h,onCancel:_},null,8,["show"]),a(Ie,{modelValue:i.value.show,"onUpdate:modelValue":L[0]||(L[0]=k=>i.value.show=k),"max-width":"400px"},{default:s(()=>[a(J,null,{default:s(()=>[a(ne,null,{default:s(()=>[w(b(i.value.title),1)]),_:1}),a(G,null,{default:s(()=>[g("p",null,b(i.value.message),1)]),_:1}),a(ye,null,{default:s(()=>[a(De),a(U,{color:"primary",variant:"text",onClick:C},{default:s(()=>[w(b(e.value.urlDialogCancel),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),zo=H(Fo,[["__scopeId","data-v-32f10594"]]),Ko={cells:[],metadata:{},nbformat:4,nbformat_minor:2},N=Qe({content:{},updated:null,clear(){this.updated=null,this.content=Ko},findCell(l){return this.content.cells?this.content.cells.find(e=>e.id===l):null},getSource(l){const e=this.findCell(l);return e?e.source:null},setSource(l,e){const t=this.findCell(l);t&&(e=e.map(o=>o+`
`),t.source=e,this.updated=Date.now())},getLocalizedSource(l,e){const t=this.findCell(l);if(!t)return;let o=t.source;return e===null||t.metadata.i18n&&t.metadata.i18n[e]&&(o=t.metadata.i18n[e]),o},setLocalizedSource(l,e,t){const o=this.findCell(l);o&&(t===null?this.setSource(l,e):(e=e.map(n=>n+`
`),o.metadata.i18n||(o.metadata.i18n={}),o.metadata.i18n[t]=e,this.updated=Date.now()))},parseGlobals(l,e){var n;if(e===null)return l;const t=(n=this.content.metadata)==null?void 0:n.globals;return t?l.map(i=>i.replace(/\{\{\s*(\w+)\s*\}\}/g,(u,r)=>{const p=t[r];if(!p)return u;const d=p[e]||p.default;return d===void 0?u:`${d}`})):l},clearOutputs(l){const e=this.findCell(l);e&&(e.outputs=[],this.updated=Date.now())},getOutputTypes(l){var o,n,i;let e=[];const t=this.findCell(l);return t&&(((o=t.outputs)==null?void 0:o.findIndex(u=>u.output_type==="execute_result"))!==-1&&e.push("result"),((n=t.outputs)==null?void 0:n.findIndex(u=>u.output_type==="stream"&&u.name==="stdout"))!==-1&&e.push("stdout"),((i=t.outputs)==null?void 0:i.findIndex(u=>u.output_type==="error"))!==-1&&e.push("error")),e},addStdout(l,e){const t=this.findCell(l);if(t){t.outputs||(t.outputs=[]);const o=t.outputs.findIndex(n=>n.output_type==="stream"&&n.name==="stdout");o!==-1?(t.outputs[o].text||(t.outputs[o].text=[]),t.outputs[o].text.push(e)):t.outputs.push({output_type:"stream",name:"stdout",text:[e]}),this.updated=Date.now()}},getStdout(l){var o;let e="";const t=this.findCell(l);return t&&((o=t.outputs)==null||o.forEach(n=>{var i;n.output_type==="stream"&&(e+=((i=n.text)==null?void 0:i.join(""))||"")})),e},setResult(l,e){const t=this.findCell(l);if(t){t.outputs||(t.outputs=[]);const o=t.outputs.findIndex(n=>n.output_type==="execute_result");if(o!==-1){const n=t.outputs[o].data||{};t.outputs[o].data={...n,...e}}else t.outputs.push({output_type:"execute_result",data:e});this.updated=Date.now()}},getResult(l){var o;let e={};const t=this.findCell(l);return t&&((o=t.outputs)==null||o.forEach(n=>{n.output_type==="execute_result"&&n.data&&(e=n.data)})),e},setError(l,e){const t=this.findCell(l);if(t){t.outputs||(t.outputs=[]);const o=Array.isArray(e)?e:e.split(`
`);t.outputs.push({output_type:"error",traceback:o}),this.updated=Date.now()}},getError(l){var o;let e="";const t=this.findCell(l);return t&&((o=t.outputs)==null||o.forEach(n=>{var i;n.output_type==="error"&&(e+=((i=n.traceback)==null?void 0:i.join(""))||"")})),e},loadNotebook(l){l.cells&&(l.cells.forEach(e=>{(!e.id||typeof e.id!="string"||e.id.trim()==="")&&(e.id=de())}),this.content=l)},hasTag(l,e){const t=this.findCell(l);return!t||!t.metadata.tags?!1:t.metadata.tags.includes(e)},addTag(l,e){const t=this.findCell(l);t&&(t.metadata.tags||(t.metadata.tags=[]),t.metadata.tags.includes(e)||(t.metadata.tags.push(e),this.updated=Date.now()))},removeTag(l,e){const t=this.findCell(l);if(t&&t.metadata.tags){const o=t.metadata.tags.indexOf(e);o!==-1&&(t.metadata.tags.splice(o,1),this.updated=Date.now())}},toggleTag(l,e){this.hasTag(l,e)?this.removeTag(l,e):this.addTag(l,e)},getGlobals(){return this.content.metadata||(this.content.metadata={}),this.content.metadata.globals||(this.content.metadata.globals={}),this.content.metadata.globals},setGlobal(l,e){const t=this.getGlobals();t[l]=e,this.updated=Date.now()},deleteGlobal(l){const e=this.getGlobals();delete e[l],this.updated=Date.now()}}),jo=2e3,qo=2e3;function Ho(l){const e=E("idle"),t=E(null);let o=null;const n=async u=>{o&&clearTimeout(o),o=setTimeout(async()=>{try{console.log(`Auto-Save: Saving Notebook ${l}`),e.value="saving";const r=JSON.parse(JSON.stringify(u));await Re(l,r),e.value="saved",t.value=new Date,console.log(`Auto-Save: Saved Notebook ${l}`),setTimeout(()=>{e.value==="saved"&&(e.value="idle")},qo)}catch(r){console.error("Auto-Save: Failed:",r),e.value="error"}},jo)},i=W(()=>N.updated,()=>{var u;N.updated!=null&&N.content&&((u=N.content.cells)==null?void 0:u.length)>0&&n(N.content)});return{saveStatus:e,lastSaved:t,stopWatcher:i}}const M=Qe({executionStatus:"idle",workerStatus:"initializing",runningCellId:null,interruptBuffer:null,fatalErrorTrace:"",inputStatus:"idle",inputPrompt:null,userInput:null,setInterruptBuffer(l){this.interruptBuffer=l},clearInterruptBuffer(){this.interruptBuffer&&(this.interruptBuffer[0]=0)},interruptExecution(){this.interruptBuffer&&(this.interruptBuffer[0]=2),this.executionStatus="idle"},setWorkerStatus(l){this.workerStatus=l},executeCell(l){this.executionStatus==="idle"&&this.workerStatus==="ready"&&(this.runningCellId=l,this.executionStatus="queued")},executionCompleted(){this.runningCellId=null,this.executionStatus="idle"},setFatalError(l){this.workerStatus="error",this.fatalErrorTrace=l},requestUserInput(l){this.inputStatus="waiting",this.userInput=null,this.inputPrompt=l},submitUserInput(l){this.inputStatus="submitted",this.userInput=l}}),Jo=["innerHTML"],Go=B({__name:"MarkdownCell",props:{cell:{},locale:{},editMode:{type:Boolean}},setup(l){const e=l,t=E("");W([()=>e.editMode,()=>e.locale],([u,r])=>{if(u){const p=N.getLocalizedSource(e.cell.id,r);t.value=p?p.join(""):""}},{immediate:!0});const o=u=>{const r=u.split(`
`);N.setLocalizedSource(e.cell.id,r,e.locale)},n=u=>u?_t.parse(u.join("")):"",i=I(()=>{const u=N.getLocalizedSource(e.cell.id,e.locale)||[];return N.parseGlobals(u,e.locale)});return(u,r)=>(v(),V(J,{variant:"text","max-width":"800",class:"pt-2 pb-2 ma-auto"},{default:s(()=>[a(G,null,{default:s(()=>[u.editMode?(v(),V(Bt,{key:1,modelValue:t.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>t.value=p),o],variant:"outlined","auto-grow":"",rows:"3","hide-details":"",class:"markdown-editor"},null,8,["modelValue"])):(v(),x("div",{key:0,innerHTML:n(i.value)},null,8,Jo))]),_:1})]),_:1}))}}),Ct=H(Go,[["__scopeId","data-v-7b690760"]]),Wo=B({__name:"CodeControls",props:{id:{}},setup(l){const e=l,t=()=>{N.clearOutputs(e.id),M.executeCell(e.id)},o=()=>{N.clearOutputs(e.id)},n=()=>{M.interruptExecution()},i=I(()=>N.hasTag(e.id,"hide_code")),u=()=>{N.toggleTag(e.id,"hide_code")};return(r,p)=>(v(),x("div",null,[g("div",null,[a(Ve,{rounded:"lg"},{default:s(()=>[a(U,{size:"32",icon:"mdi-play-outline",onClick:t,disabled:P(M).executionStatus!=="idle"||P(M).workerStatus!=="ready",loading:P(M).workerStatus!=="ready","aria-label":"Run code"},null,8,["disabled","loading"]),a(U,{size:"32",icon:"mdi-stop",onClick:n,disabled:P(M).executionStatus==="idle"||P(M).runningCellId!==r.id,"aria-label":"Stop code"},null,8,["disabled"])]),_:1}),a(Ve,{rounded:"lg",class:"pl-4"},{default:s(()=>[a(U,{size:"32",icon:"mdi-broom",onClick:o})]),_:1}),a(Ve,{rounded:"lg",class:"pl-2"},{default:s(()=>[a(U,{size:"32",icon:i.value?"mdi-eye-off":"mdi-eye",onClick:u,"aria-label":i.value?"Show code":"Hide code"},null,8,["icon","aria-label"])]),_:1})])]))}}),nt="#2e3440",St="#3b4252",st="#434c5e",Ce="#4c566a",We="#e5e9f0",Ye="#eceff4",ze="#8fbcbb",it="#88c0d0",Yo="#81a1c1",ee="#5e81ac",Zo="#bf616a",me="#d08770",Ke="#ebcb8b",ut="#a3be8c",Qo="#b48ead",dt="#d30102",lt=Ye,je=lt,Xo="#ffffff",qe=We,ea=lt,ct=St,ta=he.theme({"&":{color:nt,backgroundColor:Xo},".cm-content":{caretColor:ct,fontFamily:"JetBrainsMono, monospace"},".cm-cursor, .cm-dropCursor":{borderLeftColor:ct},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ea},".cm-panels":{backgroundColor:lt,color:Ce},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:`1px solid ${Ce}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:We},".cm-activeLine":{backgroundColor:je},".cm-selectionMatch":{backgroundColor:We},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${Ce}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:Ye},".cm-gutters":{backgroundColor:Ye,color:nt,border:"none"},".cm-activeLineGutter":{backgroundColor:je},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:qe},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:qe,borderBottomColor:qe},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:je,color:Ce}}},{dark:!1}),oa=yt.define([{tag:m.keyword,color:ee},{tag:[m.name,m.deleted,m.character,m.propertyName,m.macroName],color:me},{tag:[m.variableName],color:me},{tag:[m.function(m.variableName)],color:ee},{tag:[m.labelName],color:Yo},{tag:[m.color,m.constant(m.name),m.standard(m.name)],color:ee},{tag:[m.definition(m.name),m.separator],color:ut},{tag:[m.brace],color:ze},{tag:[m.annotation],color:dt},{tag:[m.number,m.changed,m.annotation,m.modifier,m.self,m.namespace],color:it},{tag:[m.typeName,m.className],color:Ke},{tag:[m.operator,m.operatorKeyword],color:ut},{tag:[m.tagName],color:Qo},{tag:[m.squareBracket],color:Zo},{tag:[m.angleBracket],color:me},{tag:[m.attributeName],color:Ke},{tag:[m.regexp],color:ee},{tag:[m.quote],color:St},{tag:[m.string],color:me},{tag:m.link,color:ze,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[m.url,m.escape,m.special(m.string)],color:me},{tag:[m.meta],color:it},{tag:[m.comment],color:st,fontStyle:"italic"},{tag:m.strong,fontWeight:"bold",color:ee},{tag:m.emphasis,fontStyle:"italic",color:ee},{tag:m.strikethrough,textDecoration:"line-through"},{tag:m.heading,fontWeight:"bold",color:ee},{tag:m.special(m.heading1),fontWeight:"bold",color:ee},{tag:m.heading1,fontWeight:"bold",color:ee},{tag:[m.heading2,m.heading3,m.heading4],fontWeight:"bold",color:ee},{tag:[m.heading5,m.heading6],color:ee},{tag:[m.atom,m.bool,m.special(m.variableName)],color:me},{tag:[m.processingInstruction,m.inserted],color:ze},{tag:[m.contentSeparator],color:Ke},{tag:m.invalid,color:st,borderBottom:`1px dotted ${dt}`}]),aa=[ta,kt(oa)],Vt="#2e3235",$t="#505d64",Ze="#606f7a",Le="#707d8b",la="#a0a4ae",Ee="#bdbdbd",ra="#e0e0e0",na="#fdf6e3",pe="#ff5f52",sa="#ff6e40",ia="#fa5788",ae="#facf4e",mt="#ffad42",ge="#56c8d8",ua="#7186f0",He="#cf6edf",da="#6abf69",pt="#99d066",vt="#4ebaaa",ft=pe,gt="#202325",Se="#414b46",ca=Vt,Je=$t,ma=$t,bt=la,pa=he.theme({"&":{color:Ee,backgroundColor:ca},".cm-content":{caretColor:bt,fontFamily:"JetBrainsMono, monospace"},".cm-cursor, .cm-dropCursor":{borderLeftColor:bt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ma},".cm-panels":{backgroundColor:gt,color:Le},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{outline:`1px solid ${ae}`,backgroundColor:"transparent"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:Se},".cm-activeLine":{backgroundColor:Se},".cm-selectionMatch":{backgroundColor:gt,outline:`1px solid ${vt}`},"&.cm-focused .cm-matchingBracket":{color:ra,outline:`1px solid ${vt}`},"&.cm-focused .cm-nonmatchingBracket":{color:pe},".cm-gutters":{backgroundColor:Vt,borderRight:"1px solid #4f5b66",color:Ze},".cm-activeLineGutter":{backgroundColor:Se,color:na},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Je},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Je,borderBottomColor:Je},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Se,color:Le}}},{dark:!0}),va=yt.define([{tag:m.keyword,color:He},{tag:[m.name,m.deleted,m.character,m.macroName],color:ge},{tag:[m.propertyName],color:ae},{tag:[m.variableName],color:Ee},{tag:[m.function(m.variableName)],color:ge},{tag:[m.labelName],color:He},{tag:[m.color,m.constant(m.name),m.standard(m.name)],color:ae},{tag:[m.definition(m.name),m.separator],color:ia},{tag:[m.brace],color:He},{tag:[m.annotation],color:ft},{tag:[m.number,m.changed,m.annotation,m.modifier,m.self,m.namespace],color:mt},{tag:[m.typeName,m.className],color:mt},{tag:[m.operator,m.operatorKeyword],color:ua},{tag:[m.tagName],color:sa},{tag:[m.squareBracket],color:pe},{tag:[m.angleBracket],color:Ze},{tag:[m.attributeName],color:Ee},{tag:[m.regexp],color:ft},{tag:[m.quote],color:da},{tag:[m.string],color:pt},{tag:m.link,color:ge,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[m.url,m.escape,m.special(m.string)],color:ae},{tag:[m.meta],color:Le},{tag:[m.comment],color:Le,fontStyle:"italic"},{tag:m.monospace,color:Ee},{tag:m.strong,fontWeight:"bold",color:pe},{tag:m.emphasis,fontStyle:"italic",color:pt},{tag:m.strikethrough,textDecoration:"line-through"},{tag:m.heading,fontWeight:"bold",color:ae},{tag:m.heading1,fontWeight:"bold",color:ae},{tag:[m.heading2,m.heading3,m.heading4],fontWeight:"bold",color:ae},{tag:[m.heading5,m.heading6],color:ae},{tag:[m.atom,m.bool,m.special(m.variableName)],color:ge},{tag:[m.processingInstruction,m.inserted],color:pe},{tag:[m.contentSeparator],color:ge},{tag:m.invalid,color:Ze,borderBottom:`1px dotted ${pe}`}]),fa=[pa,kt(va)],ga=["id"],ba=B({__name:"CodeEditor",props:{metadata:{},id:{},theme:{},editMode:{type:Boolean},locale:{}},setup(l){const e=l;let t=null,o=!1;const n=I(()=>{const i=N.getSource(e.id)||[];return e.editMode?i:N.parseGlobals(i,e.locale)});return X(()=>{let i=aa;switch(e.theme){case"dark":i=fa;break}const u=no.create({doc:n.value?n.value.join(""):"",extensions:[io,so(),i,he.lineWrapping,he.updateListener.of(r=>{if(r.docChanged&&!o){const p=r.state.doc.toString();N.setSource(e.id,p.includes(`
`)?p.split(`
`):[p])}})]});t=new he({state:u,parent:document.getElementById("code-editor-"+e.id)})}),W(()=>n.value,i=>{if(t&&i&&!o){const u=t.state.doc.toString(),r=i.join(""),p=u.replace(/\n+$/,""),d=r.replace(/\n+$/,"");p!==d&&(o=!0,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:r}}),o=!1)}},{deep:!0}),(i,u)=>(v(),x("div",{id:`code-editor-${e.id}`},null,8,ga))}}),ha=B({__name:"Console",props:{stdout:{}},setup(l){const e=l,t=E(null),o=()=>{if(!t.value)return;const r=`${(e.stdout?e.stdout.split(`
`).length:1)*1.2+1.5}em`;t.value.style.height=r};return W(()=>e.stdout,()=>{o()},{immediate:!0}),X(()=>{o()}),(n,i)=>(v(),x("textarea",{ref_key:"consoleRef",ref:t,class:"output-console",readonly:""},b(n.stdout),513))}}),_a=H(ha,[["__scopeId","data-v-43c05e2b"]]),ya={class:"output-console",readonly:""},ka=B({__name:"Error",props:{stderr:{}},setup(l){return(e,t)=>(v(),x("textarea",ya,b(e.stderr),1))}}),wa=H(ka,[["__scopeId","data-v-62cb5501"]]),xa=B({__name:"TextPlain",props:{value:{}},setup(l){const e=E(null);return(t,o)=>(v(),x("textarea",{ref_key:"consoleRef",ref:e,class:"output-console",readonly:""},b(Array.isArray(t.value)?t.value.join(""):t.value),513))}}),Ca=H(xa,[["__scopeId","data-v-6e2abbc4"]]),Sa=["src"],Va=B({__name:"ImagePng",props:{value:{}},setup(l){return(e,t)=>(v(),x("img",{src:`data:image/png;base64,${e.value}`},null,8,Sa))}}),$a=["src"],Ea=B({__name:"ImageSvg",props:{value:{}},setup(l){return(e,t)=>(v(),x("img",{src:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e.value)}`},null,8,$a))}}),La=B({__name:"Result",props:{value:{}},setup(l){return(e,t)=>(v(),x(Q,null,[e.value["image/svg+xml"]?(v(),V(Ea,{key:0,value:e.value["image/svg+xml"]},null,8,["value"])):D("",!0),e.value["image/png"]?(v(),V(Va,{key:1,value:e.value["image/png"]},null,8,["value"])):D("",!0),e.value["text/plain"]?(v(),V(Ca,{key:2,value:e.value["text/plain"]},null,8,["value"])):D("",!0)],64))}});function Pa(l){if(!l)return[];const e=[];return l.forEach((t,o)=>{const i=t.replace(/\n$/,"").trim();if(!i||i.startsWith("#"))return;const u=i.match(/^(\w+)\s*=\s*(.+?)\s*#\s*@param(.*)$/);if(!u)return;const[,r,p,d]=u;try{const h=Na(p),_=Ia(d.trim()),C=Da(h,_);e.push({name:r,value:h,type:C,config:_,lineNumber:o})}catch(h){console.warn(`Failed to parse parameter on line ${o+1}: ${t}`,h)}}),e}function Na(l){const e=l.trim();if(e==="True")return!0;if(e==="False")return!1;if(e==="None")return null;const t=e.match(/^["'](.*)["']$/);return t?t[1]:e.match(/^-?\d+\.?\d*$/)?e.includes(".")?parseFloat(e):parseInt(e,10):e}function Ia(l){if(!l)return{};const e=l.match(/^\[(.+)\]$/);if(e)return{options:e[1].split(",").map(i=>{const u=i.trim(),r=u.match(/^["'](.*)["']$/);return r?r[1]:u})};const t=l.match(/^\{(.+)\}$/);if(t)try{const o=t[1],n={};return o.split(",").forEach(u=>{const[r,p]=u.split(":").map(d=>d.trim());if(r&&p){const d=r.replace(/["']/g,""),h=p.replace(/["']/g,"");d==="type"?n.type=h:(d==="min"||d==="max"||d==="step")&&(n[d]=parseFloat(h))}}),n}catch{return console.warn("Failed to parse config JSON:",l),{}}return{}}function Da(l,e){return e.type==="slider"?"slider":e.type==="boolean"?"boolean":e.options&&e.options.length>0?"dropdown":typeof l=="boolean"?"boolean":"value"}function Ta(l,e,t){if(!l||e.lineNumber>=l.length)return l;const o=[...l],n=o[e.lineNumber],i=n.endsWith(`
`),r=n.replace(/\n$/,"").match(/^(\w+\s*=\s*)(.+?)(\s*#\s*@param.*)$/);if(r){const[,p,,d]=r,h=Ua(t);o[e.lineNumber]=`${p}${h}${d}${i?`
`:""}`}return o}function Ua(l){return typeof l=="boolean"?l?"True":"False":l==null?"None":typeof l=="string"?`"${l}"`:String(l)}const Ma={key:0,class:"parameter-controls mb-4"},Aa={class:"parameter-grid"},Ra={key:1,class:"slider-container"},Oa={class:"slider-layout"},Ba={key:3,class:"boolean-container"},Fa=B({__name:"ParameterControls",props:{source:{},cellId:{}},emits:["parameter-changed"],setup(l,{emit:e}){const t=l,o=e,n=I(()=>Pa(t.source)),i=(r,p)=>{if(!t.source)return;const d=Ta(t.source,r,p);o("parameter-changed",d)},u=r=>r.name.replace(/_/g," ").toLowerCase().replace(/\b\w/g,p=>p.toUpperCase());return(r,p)=>n.value.length>0?(v(),x("div",Ma,[a(J,{variant:"outlined",class:"pa-4"},{default:s(()=>[g("div",Aa,[(v(!0),x(Q,null,te(n.value,d=>{var h,_,C,$;return v(),x("div",{key:d.name,class:"parameter-item"},[d.type==="value"?(v(),V(Z,{key:0,label:u(d),"model-value":d.value,"onUpdate:modelValue":L=>i(d,L),variant:"outlined",density:"compact","hide-details":""},null,8,["label","model-value","onUpdate:modelValue"])):d.type==="slider"?(v(),x("div",Ra,[a(Ft,{class:"text-caption mb-1"},{default:s(()=>[w(b(u(d)),1)]),_:2},1024),g("div",Oa,[a(zt,{"model-value":d.value,"onUpdate:modelValue":L=>i(d,L),min:((h=d.config)==null?void 0:h.min)??0,max:((_=d.config)==null?void 0:_.max)??100,step:((C=d.config)==null?void 0:C.step)??1,"thumb-label":"",class:"slider-control","hide-details":""},null,8,["model-value","onUpdate:modelValue","min","max","step"]),a(Z,{"model-value":d.value,readonly:"",variant:"outlined",density:"compact",class:"value-display","hide-details":""},null,8,["model-value"])])])):d.type==="dropdown"?(v(),V(ve,{key:2,label:u(d),"model-value":d.value,"onUpdate:modelValue":L=>i(d,L),items:(($=d.config)==null?void 0:$.options)||[],variant:"outlined",density:"compact","hide-details":""},null,8,["label","model-value","onUpdate:modelValue","items"])):d.type==="boolean"?(v(),x("div",Ba,[a(Kt,{"model-value":d.value,"onUpdate:modelValue":L=>i(d,L),label:u(d),color:"primary","hide-details":"",inset:""},null,8,["model-value","onUpdate:modelValue","label"])])):D("",!0)])}),128))])]),_:1})])):D("",!0)}}),za=H(Fa,[["__scopeId","data-v-9ab33d5a"]]),Et=B({__name:"CodeCell",props:{cell:{},theme:{},locale:{},editMode:{type:Boolean}},setup(l){const e=l;let t=[];t=N.getOutputTypes(e.cell.id);const o=()=>{if(t.indexOf("result")!==-1)return"result";if(t.indexOf("stdout")!==-1)return"stdout";if(t.indexOf("error")!==-1)return"error"},n=E("result");W(()=>e.cell.outputs,()=>{t=N.getOutputTypes(e.cell.id),n.value="none",n.value=o()||n.value},{deep:!0});const i=p=>{const d=N.findCell(e.cell.id);d&&(d.source=p,N.updated=Date.now())},u=I(()=>N.hasTag(e.cell.id,"hide_code")),r=I(()=>{const p=e.locale,d=N.getLocalizedSource(e.cell.id,p)||[];return N.parseGlobals(d,p)});return(p,d)=>(v(),x("div",null,[a(za,{source:r.value,"cell-id":p.cell.id,onParameterChanged:i},null,8,["source","cell-id"]),a(J,{"max-width":"800",variant:"elevated",elevation:"2",color:"surface-light",class:"mb-2 pt-2 pb-2 ma-auto rounded-lg"},{default:s(()=>[u.value?D("",!0):(v(),V(G,{key:0},{default:s(()=>[a(ba,{id:p.cell.id,metadata:p.cell.metadata,theme:e.theme,locale:e.locale,editMode:e.editMode},null,8,["id","metadata","theme","locale","editMode"])]),_:1})),a(ye,{class:"pl-4 pr-4 d-flex justify-space-between"},{default:s(()=>[a(Wo,{id:p.cell.id},null,8,["id"]),a(jt,{modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=h=>n.value=h),class:"ml-auto"},{default:s(()=>[P(t).indexOf("result")!==-1?(v(),V(Be,{key:0,value:"result",icon:"",size:"32",rounded:"lg","min-width":"48"},{default:s(()=>[a(z,{icon:"mdi-monitor"})]),_:1})):D("",!0),P(t).indexOf("stdout")!==-1?(v(),V(Be,{key:1,value:"stdout",icon:"",size:"32","min-width":"48",rounded:"lg"},{default:s(()=>[a(z,{icon:"mdi-console"})]),_:1})):D("",!0),P(t).indexOf("error")!==-1?(v(),V(Be,{key:2,value:"error",icon:"",size:"32","min-width":"48",rounded:"lg"},{default:s(()=>[a(z,{icon:"mdi-alert-circle-outline"})]),_:1})):D("",!0)]),_:1},8,["modelValue"])]),_:1}),Dt(a(G,null,{default:s(()=>[a(qt,{modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=h=>n.value=h),direction:"vertical"},{default:s(()=>[a(Fe,{value:"result"},{default:s(()=>[a(La,{value:P(N).getResult(p.cell.id)},null,8,["value"])]),_:1}),a(Fe,{value:"stdout",direction:"vertical"},{default:s(()=>[a(_a,{stdout:P(N).getStdout(p.cell.id)},null,8,["stdout"])]),_:1}),a(Fe,{value:"error",direction:"vertical"},{default:s(()=>[a(wa,{stderr:P(N).getError(p.cell.id)},null,8,["stderr"])]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[Tt,e.cell.outputs?e.cell.outputs.length>0:!1]])]),_:1})]))}}),Ka={key:1,class:"video-container"},ja={key:0,class:"video-iframe-container"},qa=["src","width","height"],Ha={key:1,class:"video-fallback"},Ja={class:"text-body-2 mb-4"},Ga={class:"text-caption mt-2 text-grey"},Wa={key:2,class:"video-player-container"},Ya={key:2,class:"text-center pa-4"},Za=B({__name:"VideoCell",props:{cell:{},locale:{}},setup(l){const e=l,t=E(null),o=E(null),n=E(null),i=E(!1);E(!1);const u=k=>{const A=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/v\/([^&\n?#]+)/];for(const R of A){const j=k.match(R);if(j)return j[1]}return null},r=k=>{const A=[/vimeo\.com\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/];for(const R of A){const j=k.match(R);if(j)return j[1]}return null},p=k=>{const A=k.url,R=u(A);if(R)return{url:`https://www.youtube.com/embed/${R}`,provider:"youtube",isEmbed:!0};const j=r(A);return j?{url:`https://player.vimeo.com/video/${j}`,provider:"vimeo",isEmbed:!0}:{url:A,provider:"direct",isEmbed:!1}},d=()=>{try{const k=N.getLocalizedSource(e.cell.id,e.locale);if(!k||k.length===0)throw new Error("No video configuration found");const A=k.join("").trim(),R=JSON.parse(A);if(!R.url)throw new Error("Video URL is required");o.value={controls:!0,autoplay:!1,width:"100%",height:"auto",loop:!1,muted:!1,...R},n.value=p(R),t.value=null}catch(k){t.value=k instanceof Error?k.message:"Invalid video configuration",o.value=null,n.value=null}},h=I(()=>{if(!o.value||!n.value)return{};const k={controls:o.value.controls,autoplay:o.value.autoplay,loop:o.value.loop,muted:o.value.muted,fluid:!0,responsive:!0,playbackRates:[.5,1,1.25,1.5,2],plugins:{}};return o.value.poster&&(k.poster=o.value.poster),n.value.provider==="direct"&&(k.sources=[{src:n.value.url,type:"video/mp4"}]),k}),_=I(()=>{var k;return((k=n.value)==null?void 0:k.isEmbed)||!1}),C=I(()=>{if(!n.value||!o.value)return"";const k=new URL(n.value.url);return o.value.autoplay&&k.searchParams.set("autoplay","1"),o.value.controls||k.searchParams.set("controls","0"),o.value.loop&&k.searchParams.set("loop","1"),o.value.muted&&k.searchParams.set("muted","1"),k.toString()}),$=()=>{i.value=!0},L=()=>{var k;(k=o.value)!=null&&k.url&&window.open(o.value.url,"_blank")};return X(()=>{var k;d(),((k=n.value)==null?void 0:k.provider)==="vimeo"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&setTimeout(()=>{i.value||(i.value=!0)},2e3)}),W(()=>e.locale,()=>{d()}),(k,A)=>(v(),V(J,{variant:"text","max-width":"800",class:"pt-2 pb-2 ma-auto"},{default:s(()=>[a(G,null,{default:s(()=>[t.value?(v(),V(ue,{key:0,type:"error",variant:"tonal",text:t.value,class:"mb-4"},null,8,["text"])):o.value&&n.value?(v(),x("div",Ka,[_.value&&!i.value?(v(),x("div",ja,[g("iframe",{src:C.value,width:o.value.width,height:o.value.height==="auto"?"315":o.value.height,frameborder:"0",allowfullscreen:"",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",class:"video-iframe",onError:$},null,40,qa)])):_.value&&i.value?(v(),x("div",Ha,[a(J,{variant:"outlined",class:"pa-6 text-center"},{default:s(()=>[a(z,{size:"64",color:"grey-darken-1",class:"mb-4"},{default:s(()=>A[0]||(A[0]=[w("mdi-video-off",-1)])),_:1,__:[0]}),A[3]||(A[3]=g("h3",{class:"text-h6 mb-2"},"Video Embedding Restricted",-1)),g("p",Ja,[w(" This "+b(n.value.provider)+" video cannot be embedded in this environment. ",1),A[1]||(A[1]=g("br",null,null,-1)),A[2]||(A[2]=w(" This is common when running on localhost due to CORS restrictions. ",-1))]),a(U,{color:"primary",variant:"elevated",onClick:L,"prepend-icon":"mdi-open-in-new"},{default:s(()=>[w(" Watch on "+b(n.value.provider==="youtube"?"YouTube":"Vimeo"),1)]),_:1}),g("p",Ga," URL: "+b(o.value.url),1)]),_:1,__:[3]})])):(v(),x("div",Wa,[a(P(uo),{options:h.value,class:"video-player"},null,8,["options"])]))])):(v(),x("div",Ya,[a(_e,{indeterminate:"",color:"primary"}),A[4]||(A[4]=g("p",{class:"mt-2 text-body-2"},"Loading video...",-1))]))]),_:1})]),_:1}))}}),Lt=H(Za,[["__scopeId","data-v-5fea9b43"]]);function Qa(l){return new URLSearchParams(window.location.search).get(l)}async function Xa(l,e,t){var o;try{const n={model:l.model,messages:e,temperature:l.temperature??.7,stream:!1};l.max_tokens&&l.max_tokens!==-1&&(n.max_tokens=l.max_tokens),console.log("Sending request to:",l.url),console.log("Request body:",JSON.stringify(n,null,2));const i={"Content-Type":"application/json",Accept:"application/json"};t&&(i.Authorization=`Bearer ${t}`,console.log("Using API key authentication"));const u=await fetch(l.url,{method:"POST",headers:i,body:JSON.stringify(n)});if(console.log("Response status:",u.status),console.log("Response headers:",u.headers),!u.ok){let d=`HTTP ${u.status}: ${u.statusText}`;try{d=((o=(await u.json()).error)==null?void 0:o.message)||d}catch{}throw new Error(d)}const r=await u.json();if(!r.choices||r.choices.length===0)throw new Error("No response choices returned from API");const p=r.choices[0].message;if(!p||!p.content)throw new Error("Invalid response format from API");return{role:"assistant",content:p.content}}catch(n){throw n instanceof TypeError&&n.message.includes("fetch")?new Error("Unable to connect to the AI service. Please check if LM Studio is running and accessible."):n instanceof Error?n:new Error("An unexpected error occurred while communicating with the AI service.")}}const el={key:1,class:"chat-container"},tl={class:"text-body-2"},ol={class:"message-role"},al=["innerHTML"],ll=["innerHTML"],rl={key:1,class:"message-content"},nl={key:0,class:"message-wrapper assistant"},sl={class:"message-bubble assistant"},il={class:"message-content"},ul={key:1,class:"empty-chat"},dl={class:"chat-input-area"},cl={class:"chat-config-info mt-3"},ml={class:"config-chips"},pl={class:"chat-actions"},vl={key:2,class:"text-center pa-4"},fl=B({__name:"ChatCell",props:{cell:{},locale:{}},setup(l){const e=l,t=E(null),o=E(null),n=E(""),i=E(!1),u=E(),r=E(null),p=()=>{try{const S=N.getLocalizedSource(e.cell.id,e.locale);if(!S||S.length===0)throw new Error("No chat configuration found");const c=S.join("").trim(),f=JSON.parse(c);if(!f.url)throw new Error("Chat URL is required");if(!f.model)throw new Error("Model name is required");if(!f.messages||!Array.isArray(f.messages))throw new Error("Messages array is required");o.value={temperature:.7,max_tokens:-1,stream:!1,...f},r.value=Qa("OPENAI_API_KEY"),r.value&&console.log("Found OPENAI_API_KEY in URL parameters"),t.value=null}catch(S){t.value=S instanceof Error?S.message:"Invalid chat configuration",o.value=null}},d=I(()=>o.value?o.value.messages.filter(S=>S.role!=="system"):[]),h=I(()=>o.value?o.value.messages.find(S=>S.role==="system"):null),_=S=>{const c=/<think>([\s\S]*?)<\/think>/gi;let f=null,y=S;const q=S.match(c);return q&&q.length>0&&(f=q.map(Oe=>Oe.replace(/<\/?think>/gi,"").trim()).join(`

`),y=S.replace(c,"").trim()),{thinkingContent:f,mainContent:y,hasThinking:!!f}},C=S=>{try{const c=_t(S,{breaks:!0,gfm:!0});return typeof c=="string"?c:S}catch(c){return console.error("Failed to render markdown:",c),S}},$=S=>{const c=_(S.content);return{...c,renderedMain:S.role==="assistant"?C(c.mainContent):c.mainContent,renderedThinking:c.thinkingContent?C(c.thinkingContent):null}},L=async()=>{await Pe(),u.value&&(u.value.scrollTop=u.value.scrollHeight)},k=()=>{if(o.value)try{const c=JSON.stringify(o.value,null,2).split(`
`);N.setSource(e.cell.id,c)}catch(S){console.error("Failed to save chat configuration:",S)}},A=async()=>{if(!n.value.trim()||!o.value||i.value)return;const S={role:"user",content:n.value.trim()};o.value.messages.push(S);const c=n.value.trim();n.value="",k(),await L(),i.value=!0,t.value=null;try{const f=await Xa(o.value,o.value.messages,r.value);o.value.messages.push(f),k(),await L()}catch(f){const y=f instanceof Error?f.message:"Failed to get response from AI";t.value=y,o.value.messages.pop(),k(),n.value=c}finally{i.value=!1}},R=()=>{o.value&&(o.value.messages=o.value.messages.filter(S=>S.role==="system"),k())},j=S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),A())};return X(()=>{p()}),W(()=>e.locale,()=>{p()}),(S,c)=>(v(),V(J,{variant:"text","max-width":"800",class:"pt-2 pb-2 ma-auto"},{default:s(()=>[a(G,null,{default:s(()=>[t.value?(v(),V(ue,{key:0,type:"error",variant:"tonal",text:t.value,class:"mb-4"},null,8,["text"])):o.value?(v(),x("div",el,[h.value?(v(),V(ue,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:s(()=>[c[1]||(c[1]=g("div",{class:"text-caption text-grey-darken-1 mb-1"},"System Message:",-1)),g("div",tl,b(h.value.content),1)]),_:1,__:[1]})):D("",!0),g("div",{class:"chat-messages",ref_key:"messagesContainer",ref:u},[(v(!0),x(Q,null,te(d.value,(f,y)=>(v(),x("div",{key:y,class:re(["message-wrapper",f.role])},[g("div",{class:re(["message-bubble",f.role])},[g("div",ol,b(f.role),1),f.role==="assistant"?(v(),x(Q,{key:0},[$(f).hasThinking?(v(),V(Ht,{key:0,variant:"accordion",class:"thinking-panel mb-2"},{default:s(()=>[a(Jt,null,{default:s(()=>[a(Gt,{class:"thinking-title"},{default:s(()=>[a(z,{start:"",size:"small"},{default:s(()=>c[2]||(c[2]=[w("mdi-brain",-1)])),_:1,__:[2]}),c[3]||(c[3]=g("span",{class:"text-caption"},"Thinking Process",-1))]),_:1,__:[3]}),a(Wt,null,{default:s(()=>[g("div",{class:"thinking-content markdown-content",innerHTML:$(f).renderedThinking},null,8,al)]),_:2},1024)]),_:2},1024)]),_:2},1024)):D("",!0),g("div",{class:"message-content markdown-content",innerHTML:$(f).renderedMain},null,8,ll)],64)):(v(),x("div",rl,b(f.content),1))],2)],2))),128)),i.value?(v(),x("div",nl,[g("div",sl,[c[5]||(c[5]=g("div",{class:"message-role"},"assistant",-1)),g("div",il,[a(_e,{size:"16",width:"2",indeterminate:"",class:"mr-2"}),c[4]||(c[4]=w(" Thinking... ",-1))])])])):D("",!0),d.value.length===0&&!i.value?(v(),x("div",ul,[a(z,{size:"48",color:"grey-lighten-1",class:"mb-2"},{default:s(()=>c[6]||(c[6]=[w("mdi-chat-outline",-1)])),_:1,__:[6]}),c[7]||(c[7]=g("p",{class:"text-body-2 text-grey"},"Start a conversation...",-1))])):D("",!0)],512),g("div",dl,[a(Z,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=f=>n.value=f),placeholder:"Type your message...",variant:"outlined",density:"comfortable","hide-details":"",disabled:i.value,onKeypress:j,class:"chat-input"},{"append-inner":s(()=>[a(U,{icon:"mdi-send",size:"small",color:"primary",variant:"text",disabled:!n.value.trim()||i.value,onClick:A},null,8,["disabled"])]),_:1},8,["modelValue","disabled"])]),g("div",cl,[g("div",ml,[a(le,{size:"small",variant:"outlined",class:"mr-2"},{default:s(()=>[a(z,{start:""},{default:s(()=>c[8]||(c[8]=[w("mdi-server",-1)])),_:1,__:[8]}),w(" "+b(o.value.model),1)]),_:1}),a(le,{size:"small",variant:"outlined",class:"mr-2"},{default:s(()=>[a(z,{start:""},{default:s(()=>c[9]||(c[9]=[w("mdi-thermometer",-1)])),_:1,__:[9]}),w(" T: "+b(o.value.temperature),1)]),_:1}),a(le,{size:"small",variant:"outlined",class:"mr-2"},{default:s(()=>[a(z,{start:""},{default:s(()=>c[10]||(c[10]=[w("mdi-counter",-1)])),_:1,__:[10]}),w(" Max: "+b(o.value.max_tokens===-1?"∞":o.value.max_tokens),1)]),_:1}),r.value?(v(),V(le,{key:0,size:"small",variant:"outlined",color:"success",class:"mr-2"},{default:s(()=>[a(z,{start:""},{default:s(()=>c[11]||(c[11]=[w("mdi-key",-1)])),_:1,__:[11]}),c[12]||(c[12]=w(" Authenticated ",-1))]),_:1,__:[12]})):D("",!0)]),g("div",pl,[d.value.length>0?(v(),V(U,{key:0,size:"small",variant:"outlined",color:"warning","prepend-icon":"mdi-broom",onClick:R,disabled:i.value},{default:s(()=>c[13]||(c[13]=[w(" Clear Chat ",-1)])),_:1,__:[13]},8,["disabled"])):D("",!0)])])])):(v(),x("div",vl,[a(_e,{indeterminate:"",color:"primary"}),c[14]||(c[14]=g("p",{class:"mt-2 text-body-2"},"Loading chat...",-1))]))]),_:1})]),_:1}))}}),Pt=H(fl,[["__scopeId","data-v-1ffdee27"]]),Nt=B({__name:"InputDialog",props:{locale:{}},setup(l){const e=l,t=I(()=>Me[e.locale||"en-US"]),o=E(""),n=E(),i=I({get:()=>M.inputStatus==="waiting",set:d=>{d||(M.inputStatus="idle")}}),u=()=>{M.submitUserInput(o.value),o.value=""},r=()=>{M.submitUserInput(""),o.value=""};W(()=>i.value,async d=>{var h;d&&(await Pe(),(h=n.value)==null||h.focus())});const p=d=>{d.key==="Enter"?(d.preventDefault(),u()):d.key==="Escape"&&(d.preventDefault(),r())};return(d,h)=>(v(),V(Ie,{modelValue:i.value,"onUpdate:modelValue":h[1]||(h[1]=_=>i.value=_),"max-width":"400px",persistent:"",onKeydown:p},{default:s(()=>[a(J,null,{default:s(()=>[a(ne,null,{default:s(()=>[w(b(P(M).inputPrompt||t.value.inputDialogTitle),1)]),_:1}),a(G,null,{default:s(()=>[a(Z,{ref_key:"inputFieldRef",ref:n,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=_=>o.value=_),label:t.value.inputDialogLabel,variant:"outlined",density:"compact",onKeydown:p},null,8,["modelValue","label"])]),_:1}),a(ye,null,{default:s(()=>[a(De),a(U,{color:"grey",variant:"text",onClick:r},{default:s(()=>[w(b(t.value.inputDialogCancel),1)]),_:1}),a(U,{color:"primary",variant:"text",onClick:u},{default:s(()=>[w(b(t.value.inputDialogSubmit),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),gl={class:"pa-3"},bl={class:"pa-3"},hl={key:0,class:"pa-4 h-100"},_l={class:"d-flex align-center"},yl={class:"mb-4"},kl={key:1,class:"pa-4 text-center"},wl=B({__name:"GlobalsDialog",props:{locale:{},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(l,{emit:e}){const t=l,o=e,n=I(()=>Me[t.locale]),i=I({get:()=>t.modelValue,set:O=>o("update:modelValue",O)}),u=E({}),r=E(null),p=E(""),d=E(!1),h=I(()=>Object.keys(u.value).sort()),_=I(()=>r.value?u.value[r.value]||{}:null),C=I(()=>_.value?Object.keys(_.value).filter(O=>O!=="default"):[]),$=I(()=>{const O=Object.keys(ce),F=C.value;return O.filter(K=>!F.includes(K))}),L=()=>{u.value=JSON.parse(JSON.stringify(N.getGlobals())),h.value.length>0&&!r.value&&(r.value=h.value[0])},k=O=>{r.value=O,d.value=!1},A=()=>{d.value=!0,p.value="",r.value=null},R=()=>{p.value.trim()&&/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(p.value)&&(u.value[p.value]||(u.value[p.value]={default:""},r.value=p.value,d.value=!1,p.value=""))},j=()=>{if(!r.value)return;delete u.value[r.value];const O=h.value;O.length>0?r.value=O[0]:r.value=null},S=O=>{!r.value||!O||(u.value[r.value]||(u.value[r.value]={}),u.value[r.value][O]="")},c=O=>{!r.value||O==="default"||delete u.value[r.value][O]},f=O=>{!r.value||!O.trim()||/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(O)&&O!==r.value&&(u.value[O]||(u.value[O]=u.value[r.value],delete u.value[r.value],r.value=O))},y=()=>{Object.entries(u.value).forEach(([F,K])=>{N.setGlobal(F,K)});const O=N.getGlobals();Object.keys(O).forEach(F=>{u.value[F]||N.deleteGlobal(F)}),q()},q=()=>{i.value=!1,r.value=null,d.value=!1},Oe=O=>{var F;return O==="default"?"Default":((F=ce[O])==null?void 0:F.name)||O};return W(()=>t.modelValue,O=>{O&&L()}),(O,F)=>(v(),V(Ie,{modelValue:i.value,"onUpdate:modelValue":F[4]||(F[4]=K=>i.value=K),"max-width":"900px",persistent:""},{default:s(()=>[a(J,{height:"700px"},{default:s(()=>[a(ne,{class:"d-flex align-center"},{default:s(()=>[a(z,{class:"me-2"},{default:s(()=>F[5]||(F[5]=[w("mdi-variable",-1)])),_:1,__:[5]}),w(" "+b(n.value.globalsDialogTitle),1)]),_:1}),a(G,{class:"pa-0"},{default:s(()=>[a(ke,{"no-gutters":"",style:{height:"580px"}},{default:s(()=>[a(oe,{cols:"4",class:"border-e"},{default:s(()=>[g("div",gl,[d.value?(v(),V(Z,{key:0,modelValue:p.value,"onUpdate:modelValue":F[1]||(F[1]=K=>p.value=K),label:n.value.variableName,variant:"outlined",density:"compact",onKeydown:[rt(R,["enter"]),F[2]||(F[2]=rt(K=>d.value=!1,["escape"]))],autofocus:""},{"append-inner":s(()=>[a(U,{icon:"mdi-check",size:"small",variant:"text",onClick:R}),a(U,{icon:"mdi-close",size:"small",variant:"text",onClick:F[0]||(F[0]=K=>d.value=!1)})]),_:1},8,["modelValue","label"])):D("",!0)]),a(Ne,{density:"compact",class:"px-2"},{default:s(()=>[(v(!0),x(Q,null,te(h.value,K=>(v(),V(se,{key:K,active:r.value===K,onClick:fe=>k(K),rounded:""},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(K),1)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))]),_:1}),g("div",bl,[a(U,{onClick:A,block:"",variant:"outlined","prepend-icon":"mdi-plus",disabled:d.value},{default:s(()=>[w(b(n.value.addVariable),1)]),_:1},8,["disabled"])])]),_:1}),a(oe,{cols:"8"},{default:s(()=>[r.value?(v(),x("div",hl,[g("div",_l,[a(Z,{"model-value":r.value,label:n.value.variableName,variant:"outlined",density:"compact",class:"me-2","onUpdate:modelValue":f},null,8,["model-value","label"]),a(U,{icon:"mdi-delete",color:"error",variant:"outlined",size:"small",style:{"margin-top":"-20px"},onClick:j})]),a(Z,{modelValue:u.value[r.value].default,"onUpdate:modelValue":F[3]||(F[3]=K=>u.value[r.value].default=K),label:n.value.defaultValue,variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue","label"]),g("div",yl,[F[6]||(F[6]=g("h4",{class:"text-subtitle-1 mb-2"},"Locale Values",-1)),(v(!0),x(Q,null,te(C.value,K=>(v(),x("div",{key:K,class:"d-flex align-center mb-2"},[a(le,{size:"small",class:"me-2",style:{"min-width":"100px"}},{default:s(()=>[w(b(K),1)]),_:2},1024),a(Z,{modelValue:u.value[r.value][K],"onUpdate:modelValue":fe=>u.value[r.value][K]=fe,variant:"outlined",density:"compact",class:"me-2","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),a(U,{icon:"mdi-close",size:"small",variant:"text",onClick:fe=>c(K)},null,8,["onClick"])]))),128))]),$.value.length>0?(v(),V(ve,{key:0,items:$.value,label:n.value.addLocale,variant:"outlined",density:"compact","onUpdate:modelValue":S},{item:s(({props:K,item:fe})=>[a(se,Ut(Mt(K)),{default:s(()=>[a(ie,null,{default:s(()=>[w(b(Oe(fe.value)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["items","label"])):D("",!0)])):d.value?D("",!0):(v(),x("div",kl,[a(z,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:s(()=>F[7]||(F[7]=[w("mdi-variable",-1)])),_:1,__:[7]}),F[8]||(F[8]=g("p",{class:"text-grey"},"Select a variable to edit, or add a new one.",-1))]))]),_:1})]),_:1})]),_:1}),a(ye,null,{default:s(()=>[a(De),a(U,{onClick:q},{default:s(()=>[w(b(n.value.cancel),1)]),_:1}),a(U,{onClick:y,color:"primary"},{default:s(()=>[w(b(n.value.save),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),xl=H(wl,[["__scopeId","data-v-46213e9d"]]),Cl={class:"editor-container"},Sl={class:"d-flex align-center flex-column"},Vl={class:"d-flex align-center gap-2 mb-2"},$l=B({__name:"Editor",props:{id:{},theme:{},locale:{}},setup(l){const e=l,t=E("default"),o=I(()=>t.value&&t.value!=="default"?t.value:t.value&&t.value==="default"?null:e.locale),n=I(()=>Me[e.locale]),i=E(!1),u=I(()=>{const r=[{value:"default",title:n.value.noLanguageOverride}];return Object.entries(ce).forEach(([p,d])=>{r.push({value:p,title:d.name})}),r});return(r,p)=>(v(),x("div",Cl,[a(be,null,{default:s(()=>[P(M).workerStatus=="initializing"?(v(),V(ue,{key:0,text:n.value.notebookStarting,type:"info",variant:"tonal",density:"compact"},null,8,["text"])):D("",!0)]),_:1}),a(be,null,{default:s(()=>[P(M).workerStatus=="error"?(v(),V(ue,{key:0,text:`${n.value.notebookStartError} ${P(M).fatalErrorTrace}`,type:"error",variant:"tonal",density:"compact"},null,8,["text"])):D("",!0)]),_:1}),a(be,null,{default:s(()=>[g("div",Sl,[g("div",Vl,[a(ve,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=d=>t.value=d),items:u.value,label:n.value.languageOverride,density:"compact",variant:"outlined",style:{"min-width":"150px"},"hide-details":""},null,8,["modelValue","items","label"]),a(Ve,{divided:""},{default:s(()=>[a(U,{icon:"mdi-variable",onClick:p[1]||(p[1]=d=>i.value=!0)})]),_:1})])])]),_:1}),(v(!0),x(Q,null,te(P(N).content.cells,d=>{var h,_;return v(),x("div",null,[d.cell_type==="markdown"?(v(),V(P(Ct),{key:0,cell:d,metadata:d.metadata,locale:o.value,editMode:!0},null,8,["cell","metadata","locale"])):D("",!0),d.cell_type==="code"?(v(),V(P(Et),{key:1,cell:d,theme:e.theme,locale:o.value,editMode:!0},null,8,["cell","theme","locale"])):D("",!0),d.cell_type==="raw"&&((h=d.metadata.tags)!=null&&h.includes("video"))?(v(),V(P(Lt),{key:2,cell:d,locale:o.value},null,8,["cell","locale"])):D("",!0),d.cell_type==="raw"&&((_=d.metadata.tags)!=null&&_.includes("chat"))?(v(),V(P(Pt),{key:3,cell:d,locale:o.value},null,8,["cell","locale"])):D("",!0)])}),256)),a(Nt,{locale:e.locale},null,8,["locale"]),a(xl,{modelValue:i.value,"onUpdate:modelValue":p[2]||(p[2]=d=>i.value=d),locale:e.locale},null,8,["modelValue","locale"])]))}}),El=H($l,[["__scopeId","data-v-bca9abeb"]]),Ll={class:"viewer-container"},Pl=B({__name:"Viewer",props:{id:{},theme:{},locale:{}},setup(l){const e=l,t=I(()=>Me[e.locale]);return(o,n)=>(v(),x("div",Ll,[a(be,null,{default:s(()=>[P(M).workerStatus=="initializing"?(v(),V(ue,{key:0,text:t.value.notebookStarting,type:"info",variant:"tonal",density:"compact"},null,8,["text"])):D("",!0)]),_:1}),a(be,null,{default:s(()=>[P(M).workerStatus=="error"?(v(),V(ue,{key:0,text:`${t.value.notebookStartError} ${P(M).fatalErrorTrace}`,type:"error",variant:"tonal",density:"compact"},null,8,["text"])):D("",!0)]),_:1}),(v(!0),x(Q,null,te(P(N).content.cells,i=>{var u,r;return v(),x("div",null,[i.cell_type==="markdown"?(v(),V(P(Ct),{key:0,cell:i,metadata:i.metadata,locale:e.locale,editMode:!1},null,8,["cell","metadata","locale"])):D("",!0),i.cell_type==="code"?(v(),V(P(Et),{key:1,cell:i,theme:e.theme,locale:e.locale,editMode:!1},null,8,["cell","theme","locale"])):D("",!0),i.cell_type==="raw"&&((u=i.metadata.tags)!=null&&u.includes("video"))?(v(),V(P(Lt),{key:2,cell:i,locale:e.locale},null,8,["cell","locale"])):D("",!0),i.cell_type==="raw"&&((r=i.metadata.tags)!=null&&r.includes("chat"))?(v(),V(P(Pt),{key:3,cell:i,locale:e.locale},null,8,["cell","locale"])):D("",!0)])}),256)),a(Nt,{locale:e.locale},null,8,["locale"])]))}}),Nl=H(Pl,[["__scopeId","data-v-17948943"]]),Il=B({__name:"PyodideProvider",props:{notebookId:{},locale:{}},setup(l){const e=l;let t;return X(async()=>{console.log("PyodideProvider: Starting new worker for "+e.notebookId),M.setWorkerStatus("initializing"),t=new Worker(new URL("/sendai/assets/PyodideWorker-DCpjE9aV.js",import.meta.url),{type:"module"}),t.postMessage({type:"initialize"}),t.onmessage=async o=>{const{type:n,text:i,result:u,message:r,error:p,interruptBuffer:d}=o.data;switch(n){case"initialized":console.log("PyodideProvider: Pyodide is initialized"),M.setWorkerStatus("ready"),d&&(M.setInterruptBuffer(new Int32Array(d)),console.log("PyodideProvider: Set Interrupt Buffer"));break;case"stdout":M.runningCellId&&N.addStdout(M.runningCellId,i);break;case"input_request":M.requestUserInput(r);break;case"execute_result":M.runningCellId&&u&&N.setResult(M.runningCellId,u);break;case"execute_completed":M.executionCompleted();break;case"error":M.runningCellId&&N.setError(M.runningCellId,p),M.executionCompleted();break;case"fatal":M.setFatalError(p);break}}}),et(async()=>{console.log("PyodideProvider: Terminating worker."),M.setWorkerStatus("terminating"),t.terminate()}),W(()=>M.executionStatus,o=>{if(o==="queued"&&M.runningCellId!=null){const n=N.parseGlobals(N.getLocalizedSource(M.runningCellId,e.locale)||[],e.locale);t.postMessage({type:"run",cellId:M.runningCellId,code:n==null?void 0:n.join("")})}}),W(()=>M.inputStatus,o=>{o==="submitted"&&t.postMessage({type:"input_response",value:M.userInput})}),(o,n)=>At(o.$slots,"default")}}),Dl=B({__name:"Renderer",props:{id:{},initialNotebook:{},theme:{},locale:{},editMode:{type:Boolean}},setup(l){const e=l;return X(()=>{N.loadNotebook(e.initialNotebook)}),W(()=>e.initialNotebook,t=>{N.loadNotebook(t)}),(t,o)=>(v(),V(Il,{notebookId:t.id,locale:t.locale},{default:s(()=>[t.editMode?(v(),V(El,{key:0,id:t.id,theme:t.theme,locale:t.locale},null,8,["id","theme","locale"])):(v(),V(Nl,{key:1,id:t.id,theme:t.theme,locale:t.locale},null,8,["id","theme","locale"]))]),_:1},8,["notebookId","locale"]))}}),Tl={class:"ai-assistant"},Ul={class:"assistant-header"},Ml={class:"d-flex align-center justify-space-between"},Al={class:"d-flex align-center"},Rl={class:"message-role"},Ol=["innerHTML"],Bl={key:1,class:"message-content"},Fl={key:2,class:"message-content"},zl={key:0,class:"message-wrapper assistant"},Kl={class:"message-bubble assistant"},jl={class:"message-content"},ql={key:0,class:"preset-questions"},Hl={class:"preset-chips"},Jl={class:"chat-input-area"},Gl=B({__name:"AIAssistant",props:{notebookTitle:{}},setup(l){let e,t,o,n=[];const i=E(""),u=E(!1),r=E(),p=["What are the key concepts covered in this lesson?","Does this lesson meet standards?","Localize this lesson into my language","How can I improve this lesson?","Make this lesson suitable for a K-5 class"],d=c=>"role"in c&&c.role==="user",h=c=>"role"in c&&c.role==="assistant",_=c=>{const f=c.content.find(y=>y.type==="output_text");return(f==null?void 0:f.text)||""},C=c=>{if(typeof c.content=="string")return c.content;const f=c.content.find(y=>y.type==="input_text");return(f==null?void 0:f.text)||""},$=I(()=>n.length>0),L=c=>{try{const f=ro(c,{breaks:!0,gfm:!0});return typeof f=="string"?f:c}catch(f){return console.error("Failed to render markdown:",f),c}},k=async()=>{await Pe(),r.value&&(r.value.scrollTop=r.value.scrollHeight)},A=async()=>{if(!i.value.trim()||u.value)return;const c={role:"user",content:i.value.trim()},f=n.concat(c);i.value="",n=f,await k(),u.value=!0;const y=await o.run(t,f);u.value=!1,n=y.history,await k()},R=c=>{i.value=c,A()},j=()=>{n=[]},S=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),A())};return X(()=>{var c,f,y;e=new co({baseURL:(c=T.getDefaultProvider())==null?void 0:c.url,apiKey:(f=T.getDefaultProvider())==null?void 0:f.apiKey,dangerouslyAllowBrowser:!0}),t=new mo({name:"Lesson Assistant",instructions:"You are a helpful assistant to assist with lesson content and improvements.",model:(y=T.getDefaultProvider())==null?void 0:y.selectedModel}),vo(e),o=new po}),(c,f)=>(v(),x("div",Tl,[g("div",Ul,[g("div",Ml,[g("div",Al,[a(z,{icon:"mdi-creation",class:"me-2",color:"primary"}),f[1]||(f[1]=g("h3",{class:"text-h7"},"Lesson Assistant",-1))]),$.value?(v(),V(U,{key:0,icon:"mdi-broom",size:"small",variant:"text",color:"warning",onClick:j,disabled:u.value},{default:s(()=>[a(z,null,{default:s(()=>f[2]||(f[2]=[w("mdi-broom",-1)])),_:1,__:[2]}),a($e,{activator:"parent",location:"bottom"},{default:s(()=>f[3]||(f[3]=[w("Clear Chat",-1)])),_:1,__:[3]})]),_:1},8,["disabled"])):D("",!0)])]),g("div",{class:"chat-messages",ref_key:"messagesContainer",ref:r},[(v(!0),x(Q,null,te(P(n),y=>(v(),x("div",{key:y.id,class:re(["message-wrapper",{user:d(y),assistant:h(y)}])},[g("div",{class:re(["message-bubble",{user:d(y),assistant:h(y)}])},[g("div",Rl,b(d(y)?"user":h(y)?"assistant":"system"),1),h(y)?(v(),x("div",{key:0,class:"message-content markdown-content",innerHTML:L(_(y))},null,8,Ol)):d(y)?(v(),x("div",Bl,b(C(y)),1)):(v(),x("div",Fl,b(JSON.stringify(y)),1))],2)],2))),128)),u.value?(v(),x("div",zl,[g("div",Kl,[f[5]||(f[5]=g("div",{class:"message-role"},"assistant",-1)),g("div",jl,[a(_e,{size:"16",width:"2",indeterminate:"",class:"me-2"}),f[4]||(f[4]=w(" Thinking... ",-1))])])])):D("",!0)],512),!$.value||P(n).length===1?(v(),x("div",ql,[f[6]||(f[6]=g("div",{class:"text-caption text-medium-emphasis mb-2"},"Quick questions:",-1)),g("div",Hl,[(v(),x(Q,null,te(p,y=>a(le,{key:y,size:"small",variant:"outlined",class:"ma-1",onClick:q=>R(y),disabled:u.value},{default:s(()=>[w(b(y),1)]),_:2},1032,["onClick","disabled"])),64))])])):D("",!0),g("div",Jl,[a(Z,{modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=y=>i.value=y),placeholder:"Ask me anything about this lesson...",variant:"outlined",density:"compact","hide-details":"",disabled:u.value,onKeypress:S,class:"chat-input"},{"append-inner":s(()=>[a(U,{icon:"mdi-send",size:"small",color:"primary",variant:"text",disabled:!i.value.trim()||u.value,onClick:A},null,8,["disabled"])]),_:1},8,["modelValue","disabled"])])]))}}),Wl=H(Gl,[["__scopeId","data-v-6d67b8f9"]]),Yl={class:"notebook"},Zl={class:"d-flex align-center mb-6 notebook-header"},Ql={class:"d-flex align-center flex-grow-1"},Xl={class:"text-h4 notebook-title"},er={key:1,class:"loading"},tr={class:"text-center"},or={class:"text-h5 mb-2"},ar={class:"text-body-1 text-medium-emphasis mb-4"},lr=B({__name:"Notebook",setup(l){const e=at(),t=ot(),o=I(()=>Ue[T.locale]),n=I(()=>ce[T.locale].direction==="rtl"),i=I(()=>e.params.id),u=E(null),r=E(!0),p=E(null),d=E(!1),h=E(!1),_=E(!1),{saveStatus:C,stopWatcher:$}=Ho(i.value);X(async()=>{try{r.value=!0,p.value=null,u.value=await xt(i.value)}catch(j){console.error("Failed to load notebook:",j),p.value=j instanceof Error?j.message:"Failed to load notebook"}finally{r.value=!1}});const L=()=>{t.push("/notebooks")},k=()=>{d.value=!d.value},A=()=>{_.value=!_.value},R=()=>{h.value=!h.value};return et(()=>{N.clear(),$()}),(j,S)=>(v(),x("div",Yl,[a(Te,{fluid:"",class:"pa-4"},{default:s(()=>{var c,f;return[g("div",Zl,[g("div",Ql,[a(U,{icon:n.value?"mdi-arrow-right":"mdi-arrow-left",variant:"text",onClick:L,class:re(n.value?"ms-3":"me-3")},null,8,["icon","class"]),g("h1",Xl,b(((f=(c=u.value)==null?void 0:c.metadata)==null?void 0:f.title)||o.value.untitledNotebook),1)]),P(C)!=="idle"?(v(),V(le,{key:0,color:P(C)==="saved"?"success":P(C)==="saving"?"info":"error",size:"small",variant:"tonal"},{default:s(()=>[a(z,{icon:P(C)==="saved"?"mdi-check":P(C)==="saving"?"mdi-loading":"mdi-alert",class:re([{"mdi-spin":P(C)==="saving"},"me-1"]),size:"small"},null,8,["icon","class"]),w(" "+b(P(C)==="saved"?o.value.saved:P(C)==="saving"?o.value.saving:o.value.saveError),1)]),_:1},8,["color"])):D("",!0),g("div",{class:re(["d-flex align-center",n.value?"ms-3":"me-3"])},[a(U,{icon:"mdi-pencil",variant:"text",size:"small",color:d.value?"primary":"default",onClick:k,class:"me-2"},{default:s(()=>[a(z,null,{default:s(()=>S[1]||(S[1]=[w("mdi-pencil",-1)])),_:1,__:[1]}),a($e,{activator:"parent",location:"bottom"},{default:s(()=>S[2]||(S[2]=[w(" Edit Notebook ",-1)])),_:1,__:[2]})]),_:1},8,["color"]),a(U,{icon:"mdi-assistant",variant:"text",size:"small",color:_.value?"primary":"default",onClick:A,class:"me-2"},{default:s(()=>[a(z,null,{default:s(()=>S[3]||(S[3]=[w("mdi-creation",-1)])),_:1,__:[3]}),a($e,{activator:"parent",location:"bottom"},{default:s(()=>S[4]||(S[4]=[w(" Lesson Assistant ",-1)])),_:1,__:[4]})]),_:1},8,["color"]),a(U,{icon:"mdi-paperclip",variant:"text",size:"small",color:h.value?"primary":"default",onClick:R},{default:s(()=>[a(z,null,{default:s(()=>S[5]||(S[5]=[w("mdi-paperclip",-1)])),_:1,__:[5]}),a($e,{activator:"parent",location:"bottom"},{default:s(()=>S[6]||(S[6]=[w(" Resources ",-1)])),_:1,__:[6]})]),_:1},8,["color"])],2)]),u.value&&!r.value&&!p.value?(v(),V(Dl,{key:0,"initial-notebook":u.value,id:i.value,theme:P(T).theme,locale:P(T).locale,editMode:d.value},null,8,["initial-notebook","id","theme","locale","editMode"])):r.value?(v(),x("div",er,[a(_e,{indeterminate:"",color:"primary"}),g("p",null,b(o.value.loadingNotebook),1)])):p.value?(v(),V(J,{key:2,class:"pa-6"},{default:s(()=>[g("div",tr,[a(z,{icon:"mdi-alert-circle",size:"64",color:"error",class:"mb-4"}),g("h2",or,b(o.value.failedToLoad),1),g("p",ar,b(p.value),1),a(U,{color:"primary",onClick:L},{default:s(()=>[w(b(o.value.backToNotebooks),1)]),_:1})])]),_:1})):D("",!0)]}),_:1}),a(Yt,{modelValue:_.value,"onUpdate:modelValue":S[0]||(S[0]=c=>_.value=c),location:"end",width:400,temporary:!1,class:"ai-assistant-drawer"},{default:s(()=>{var c,f;return[a(Wl,{"notebook-title":(f=(c=u.value)==null?void 0:c.metadata)==null?void 0:f.title},null,8,["notebook-title"])]}),_:1},8,["modelValue"])]))}}),rr=H(lr,[["__scopeId","data-v-e0f5ca82"]]),nr={class:"notebook-json"},sr=B({__name:"NotebookJSON",setup(l){const e=at(),t=I(()=>e.params.id),o=E(null),n=E(!0),i=E(null);X(async()=>{try{n.value=!0,i.value=null,o.value=await xt(t.value)}catch(r){console.error("Failed to load notebook:",r),i.value=r instanceof Error?r.message:"Failed to load notebook"}finally{n.value=!1}});const u=I(()=>i.value?JSON.stringify({error:i.value,message:"Notebook not found or could not be loaded"},null,2):o.value?JSON.stringify(o.value,null,2):JSON.stringify({message:"Loading..."},null,2));return(r,p)=>(v(),x("div",nr,[g("pre",null,b(u.value),1)]))}}),ir=H(sr,[["__scopeId","data-v-738b6e09"]]),ur={class:"curriculum-view"},dr=B({__name:"Curriculum",setup(l){return(e,t)=>(v(),x("div",ur,[a(Te,null,{default:s(()=>[a(ke,null,{default:s(()=>[a(oe,{cols:"12"},{default:s(()=>[t[1]||(t[1]=g("h1",{class:"text-h4 mb-4"},"Curriculum",-1)),a(J,null,{default:s(()=>[a(G,null,{default:s(()=>t[0]||(t[0]=[g("p",{class:"text-body-1"}," Curriculum content will be implemented here. This section will contain educational materials, lessons, and structured learning paths. ",-1)])),_:1,__:[0]})]),_:1})]),_:1,__:[1]})]),_:1})]),_:1})]))}}),cr=H(dr,[["__scopeId","data-v-4427f550"]]),mr=[{name:"LM Studio",url:"http://localhost:1234/v1"},{name:"OpenRouter",url:"https://openrouter.ai/api/v1"},{name:"OpenAI",url:"https://api.openai.com/v1"}],pr={key:0,class:"text-center py-8"},vr={class:"text-body-1 text-medium-emphasis"},fr={key:1,class:"provider-list"},gr={class:"d-flex align-center gap-2 mb-2"},br={key:0},hr={class:"d-flex justify-space-between align-start mb-3"},_r={class:"flex-grow-1"},yr={class:"text-h6"},kr={class:"text-body-2 text-medium-emphasis"},wr={key:0,class:"text-body-2"},xr={class:"d-flex gap-2 flex-shrink-0"},Cr={key:1},Sr={class:"d-flex gap-2"},Vr={key:0,class:"text-error text-caption mt-1"},$r={class:"d-flex justify-end gap-2 mt-3"},Er=B({__name:"AIProviderManager",setup(l){const e=mr,t=E(null),o=E({}),n=E({}),i=E({}),u=I(()=>wt[T.locale]),r=E({name:"",url:"",apiKey:"",selectedModel:"",type:""}),p=c=>{t.value=c.id,r.value={name:c.name,url:c.url,apiKey:c.apiKey,selectedModel:c.selectedModel,type:c.type},i.value={}},d=()=>{t.value=null,r.value={name:"",url:"",apiKey:"",selectedModel:"",type:""},i.value={}},h=()=>(i.value={},r.value.name.trim()||(i.value.name=u.value.providerNameRequired),r.value.url.trim()?Ge.validateUrl(r.value.url)||(i.value.url=u.value.invalidUrl):i.value.url=u.value.urlRequired,r.value.apiKey.trim()||(i.value.apiKey=u.value.apiKeyRequired),Object.keys(i.value).length===0),_=async()=>{if(!h()||!t.value)return;const c={name:r.value.name.trim(),url:r.value.url.trim(),apiKey:r.value.apiKey.trim(),selectedModel:r.value.selectedModel,type:r.value.type};T.updateProvider(t.value,c),d()},C=c=>{const f={name:c.name,url:c.url,apiKey:"",selectedModel:"",type:c.name,models:[]};T.addProvider(f);const y=T.aiProviders[T.aiProviders.length-1];y&&p(y)},$=c=>{T.removeProvider(c)},L=c=>{T.setDefaultProvider(c)},k=async c=>{if(!(!c.apiKey||!c.url)){o.value[c.id]=!0,n.value[c.id]="";try{const f=await Ge.fetchModels(c.url,c.apiKey);T.updateProvider(c.id,{models:f}),!c.selectedModel&&f.length>0&&T.updateProvider(c.id,{selectedModel:f[0].id})}catch(f){n.value[c.id]=u.value.errorLoadingModels,console.error("Error fetching models:",f)}finally{o.value[c.id]=!1}}},A=(c,f)=>{T.updateProvider(c,{selectedModel:f})};let R=null;const j=async()=>{R&&clearTimeout(R),R=setTimeout(async()=>{if(r.value.apiKey.trim()&&r.value.url.trim()&&t.value){const c=T.aiProviders.find(f=>f.id===t.value);c&&(T.updateProvider(t.value,{apiKey:r.value.apiKey.trim(),url:r.value.url.trim()}),await k({...c,apiKey:r.value.apiKey.trim(),url:r.value.url.trim()}))}},1e3)},S=async()=>{R&&clearTimeout(R),R=setTimeout(async()=>{if(r.value.apiKey.trim()&&r.value.url.trim()&&t.value){const c=T.aiProviders.find(f=>f.id===t.value);c&&(T.updateProvider(t.value,{apiKey:r.value.apiKey.trim(),url:r.value.url.trim()}),await k({...c,apiKey:r.value.apiKey.trim(),url:r.value.url.trim()}))}},1e3)};return X(()=>{T.aiProviders.forEach(c=>{c.apiKey&&c.url&&(!c.models||c.models.length===0)&&k(c)})}),(c,f)=>(v(),V(J,{class:"mb-4"},{default:s(()=>[a(ne,{class:"d-flex justify-space-between align-center"},{default:s(()=>[w(b(u.value.aiProviders)+" ",1),a(tt,null,{activator:s(({props:y})=>[a(U,Xe({color:"primary",variant:"outlined"},y,{"prepend-icon":"mdi-plus"}),{default:s(()=>[w(b(u.value.add),1)]),_:2},1040)]),default:s(()=>[a(Ne,null,{default:s(()=>[(v(!0),x(Q,null,te(P(e),y=>(v(),V(se,{key:y.name,onClick:q=>C(y)},{default:s(()=>[a(ie,null,{default:s(()=>[w(b(y.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),a(G,null,{default:s(()=>[P(T).aiProviders.length===0?(v(),x("div",pr,[a(z,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:s(()=>f[4]||(f[4]=[w("mdi-robot-outline",-1)])),_:1,__:[4]}),g("p",vr,b(u.value.noProviders),1)])):(v(),x("div",fr,[(v(!0),x(Q,null,te(P(T).aiProviders,y=>(v(),V(J,{key:y.id,class:"mb-3",variant:y.isDefault?"tonal":"outlined"},{default:s(()=>[a(G,null,{default:s(()=>[g("div",gr,[y.isDefault?(v(),V(le,{key:0,color:"primary",size:"small"},{default:s(()=>[w(b(u.value.defaultProvider),1)]),_:1})):D("",!0),y.isDefault?D("",!0):(v(),V(U,{key:1,size:"small",variant:"outlined",onClick:q=>L(y.id)},{default:s(()=>[w(b(u.value.setDefault),1)]),_:2},1032,["onClick"]))]),t.value!==y.id?(v(),x("div",br,[g("div",hr,[g("div",_r,[g("h3",yr,b(y.name),1),g("p",kr,b(y.url),1),y.selectedModel?(v(),x("p",wr," Model: "+b(y.selectedModel),1)):D("",!0)]),g("div",xr,[a(U,{size:"small",variant:"outlined",icon:"mdi-pencil",onClick:q=>p(y)},null,8,["onClick"]),a(U,{size:"small",variant:"outlined",color:"error",icon:"mdi-delete",onClick:q=>$(y.id)},null,8,["onClick"])])])])):(v(),x("div",Cr,[a(ke,null,{default:s(()=>[a(oe,{cols:"12",md:"6"},{default:s(()=>[a(Z,{modelValue:r.value.name,"onUpdate:modelValue":f[0]||(f[0]=q=>r.value.name=q),label:u.value.providerName,"error-messages":i.value.name,variant:"outlined",density:"compact"},null,8,["modelValue","label","error-messages"])]),_:1}),a(oe,{cols:"12",md:"6"},{default:s(()=>[a(Z,{modelValue:r.value.url,"onUpdate:modelValue":[f[1]||(f[1]=q=>r.value.url=q),S],label:u.value.providerUrl,"error-messages":i.value.url,variant:"outlined",density:"compact"},null,8,["modelValue","label","error-messages"])]),_:1}),a(oe,{cols:"12",md:"8"},{default:s(()=>[a(Z,{modelValue:r.value.apiKey,"onUpdate:modelValue":[f[2]||(f[2]=q=>r.value.apiKey=q),j],label:u.value.apiKey,"error-messages":i.value.apiKey,type:"password",variant:"outlined",density:"compact"},null,8,["modelValue","label","error-messages"])]),_:1}),a(oe,{cols:"12",md:"4"},{default:s(()=>[g("div",Sr,[a(ve,{modelValue:r.value.selectedModel,"onUpdate:modelValue":[f[3]||(f[3]=q=>r.value.selectedModel=q),q=>A(y.id,q)],items:y.models||[],"item-title":"id","item-value":"id",label:u.value.models,variant:"outlined",density:"compact",loading:o.value[y.id],disabled:!y.models||y.models.length===0},null,8,["modelValue","items","label","loading","disabled","onUpdate:modelValue"]),a(U,{icon:"mdi-refresh",size:"small",variant:"outlined",loading:o.value[y.id],disabled:!r.value.apiKey||!r.value.url,onClick:q=>k(y)},null,8,["loading","disabled","onClick"])]),n.value[y.id]?(v(),x("div",Vr,b(n.value[y.id]),1)):D("",!0)]),_:2},1024)]),_:2},1024),g("div",$r,[a(U,{variant:"outlined",onClick:d},{default:s(()=>[w(b(u.value.cancelEdit),1)]),_:1}),a(U,{color:"primary",onClick:_},{default:s(()=>[w(b(u.value.saveProvider),1)]),_:1})])]))]),_:2},1024)]),_:2},1032,["variant"]))),128))]))]),_:1})]),_:1}))}}),Lr=H(Er,[["__scopeId","data-v-57b64f3c"]]),Pr={class:"settings-view"},Nr={class:"text-h4 mb-4 settings-title"},Ir={class:"text-body-1"},Dr={class:"text-body-2 text-medium-emphasis"},Tr=B({__name:"Settings",setup(l){const e=ht(),t=E(T.theme),o=E(T.locale),n=I(()=>_o.map(d=>({title:bo[T.locale][d],value:d}))),i=fo.map(d=>({title:ce[d].name,value:d})),u=I(()=>wt[T.locale]);X(()=>{e.global.name.value=T.theme}),W(t,d=>{e.global.name.value=d});const r=d=>{T.setTheme(d),t.value=d},p=d=>{T.setLocale(d),o.value=d};return(d,h)=>(v(),x("div",Pr,[a(Te,null,{default:s(()=>[a(ke,null,{default:s(()=>[a(oe,{cols:"12"},{default:s(()=>[g("h1",Nr,b(u.value.title),1),a(J,{class:"mb-4"},{default:s(()=>[a(ne,null,{default:s(()=>[w(b(u.value.appearance),1)]),_:1}),a(G,null,{default:s(()=>[a(ve,{modelValue:t.value,"onUpdate:modelValue":[h[0]||(h[0]=_=>t.value=_),r],items:n.value,label:u.value.theme,"item-title":"title","item-value":"value"},null,8,["modelValue","items","label"])]),_:1})]),_:1}),a(J,{class:"mb-4"},{default:s(()=>[a(ne,null,{default:s(()=>[w(b(u.value.language),1)]),_:1}),a(G,null,{default:s(()=>[a(ve,{modelValue:o.value,"onUpdate:modelValue":[h[1]||(h[1]=_=>o.value=_),p],items:P(i),label:u.value.language,"item-title":"title","item-value":"value"},null,8,["modelValue","items","label"])]),_:1})]),_:1}),a(Lr),a(J,null,{default:s(()=>[a(ne,null,{default:s(()=>[w(b(u.value.about),1)]),_:1}),a(G,null,{default:s(()=>[g("p",Ir,b(u.value.appName),1),g("p",Dr,b(u.value.version)+" 0.1.0 ",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Ur=H(Tr,[["__scopeId","data-v-f778c09e"]]),Mr=[{path:"/",redirect:"notebooks"},{path:"/notebooks",name:"notebooks",component:zo},{path:"/notebooks/:id/json",name:"notebook-json",component:ir},{path:"/notebooks/:id",name:"notebook",component:rr},{path:"/curriculum",name:"curriculum",component:cr},{path:"/settings",name:"settings",component:Ur}],Ar=ao({history:lo("/sendai/"),routes:Mr}),Rr={class:"content-container"},Or=B({__name:"BaseLayout",setup(l){const e=()=>{const _=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${_}px`)},t=ot(),o=at(),n={"/notebooks":0,"/curriculum":1,"/settings":2},i={0:"/notebooks",1:"/curriculum",2:"/settings"},u=I({get:()=>n[o.path]??0,set:_=>{const C=i[_];C&&o.path!==C&&t.push(C)}}),r=ht(),p=I(()=>ho[T.locale]),d=I(()=>ce[T.locale].direction),h=I(()=>T.locale);return W([d,h],([_,C])=>{document.documentElement.dir=_,document.documentElement.lang=C},{immediate:!0}),X(()=>{r.global.name.value=T.theme,document.documentElement.dir=d.value,document.documentElement.lang=h.value,e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e)}),et(()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}),(_,C)=>{const $=Rt("router-view");return v(),V(Zt,null,{default:s(()=>[a(Qt,null,{default:s(()=>[g("div",Rr,[a($)])]),_:1}),a(Xt,{modelValue:u.value,"onUpdate:modelValue":C[0]||(C[0]=L=>u.value=L),color:"primary",grow:"",class:re({"rtl-navigation":d.value==="rtl"})},{default:s(()=>[a(U,{value:"0"},{default:s(()=>[a(z,null,{default:s(()=>C[1]||(C[1]=[w("mdi-notebook",-1)])),_:1,__:[1]}),g("span",null,b(p.value.notebooks),1)]),_:1}),a(U,{value:"1"},{default:s(()=>[a(z,null,{default:s(()=>C[2]||(C[2]=[w("mdi-school",-1)])),_:1,__:[2]}),g("span",null,b(p.value.curriculum),1)]),_:1}),a(U,{value:"2"},{default:s(()=>[a(z,null,{default:s(()=>C[3]||(C[3]=[w("mdi-cog",-1)])),_:1,__:[3]}),g("span",null,b(p.value.settings),1)]),_:1})]),_:1},8,["modelValue","class"])]),_:1})}}}),Br=H(Or,[["__scopeId","data-v-77271b7e"]]),Fr=B({__name:"App",setup(l){return(e,t)=>(v(),V(Br))}}),zr=eo({theme:{defaultTheme:"dark",themes:{light:{colors:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}},dark:{colors:{primary:"#2196F3",secondary:"#424242",accent:"#FF4081",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}},icons:{defaultSet:"mdi",aliases:oo,sets:{mdi:to}}});Ot(Fr).use(zr).use(Ar).mount("#app");
