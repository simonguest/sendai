import{r as ar,g as ir}from"./@babel-CCFhuYdL.js";import{r as er,w as T}from"./global-Ao-oLW3a.js";import{r as ur}from"./is-function-C0BzV8h3.js";import{U as J}from"./url-toolkit-Dcj1b7Pi.js";var H={exports:{}},P,Y;function or(){if(Y)return P;Y=1;var i=er(),r=function(t,a){return a===void 0&&(a=!1),function(u,f,v){if(u){t(u);return}if(f.statusCode>=400&&f.statusCode<=599){var c=v;if(a)if(i.TextDecoder){var g=e(f.headers&&f.headers["content-type"]);try{c=new TextDecoder(g).decode(v)}catch{}}else c=String.fromCharCode.apply(null,new Uint8Array(v));t({cause:c});return}t(null,v)}};function e(n){return n===void 0&&(n=""),n.toLowerCase().split(";").reduce(function(t,a){var u=a.split("="),f=u[0],v=u[1];return f.trim()==="charset"?v.trim():t},"utf-8")}return P=r,P}var W;function fr(){if(W)return H.exports;W=1;var i=er(),r=ar(),e=ur();f.httpHandler=or();/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bj√∂rklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var n=function(p){var x={};return p&&p.trim().split(`
`).forEach(function(A){var D=A.indexOf(":"),E=A.slice(0,D).trim().toLowerCase(),F=A.slice(D+1).trim();typeof x[E]>"u"?x[E]=F:Array.isArray(x[E])?x[E].push(F):x[E]=[x[E],F]}),x};H.exports=f,H.exports.default=f,f.XMLHttpRequest=i.XMLHttpRequest||g,f.XDomainRequest="withCredentials"in new f.XMLHttpRequest?f.XMLHttpRequest:i.XDomainRequest,t(["get","put","post","patch","head","delete"],function(o){f[o==="delete"?"del":o]=function(p,x,A){return x=u(p,x,A),x.method=o.toUpperCase(),v(x)}});function t(o,p){for(var x=0;x<o.length;x++)p(o[x])}function a(o){for(var p in o)if(o.hasOwnProperty(p))return!1;return!0}function u(o,p,x){var A=o;return e(p)?(x=p,typeof o=="string"&&(A={uri:o})):A=r({},p,{uri:o}),A.callback=x,A}function f(o,p,x){return p=u(o,p,x),v(p)}function v(o){if(typeof o.callback>"u")throw new Error("callback argument missing");var p=!1,x=function(C,S,tr){p||(p=!0,o.callback(C,S,tr))};function A(){s.readyState===4&&setTimeout(F,0)}function D(){var d=void 0;if(s.response?d=s.response:d=s.responseText||c(s),V)try{d=JSON.parse(d)}catch{}return d}function E(d){return clearTimeout(I),d instanceof Error||(d=new Error(""+(d||"Unknown XMLHttpRequest Error"))),d.statusCode=0,x(d,$)}function F(){if(!M){var d;clearTimeout(I),o.useXDR&&s.status===void 0?d=200:d=s.status===1223?204:s.status;var C=$,S=null;return d!==0?(C={body:D(),statusCode:d,method:R,headers:{},url:O,rawRequest:s},s.getAllResponseHeaders&&(C.headers=n(s.getAllResponseHeaders()))):S=new Error("Internal XMLHttpRequest Error"),x(S,C,C.body)}}var s=o.xhr||null;s||(o.cors||o.useXDR?s=new f.XDomainRequest:s=new f.XMLHttpRequest);var k,M,O=s.url=o.uri||o.url,R=s.method=o.method||"GET",_=o.body||o.data,L=s.headers=o.headers||{},U=!!o.sync,V=!1,I,$={body:void 0,headers:{},statusCode:0,method:R,url:O,rawRequest:s};if("json"in o&&o.json!==!1&&(V=!0,L.accept||L.Accept||(L.Accept="application/json"),R!=="GET"&&R!=="HEAD"&&(L["content-type"]||L["Content-Type"]||(L["Content-Type"]="application/json"),_=JSON.stringify(o.json===!0?_:o.json))),s.onreadystatechange=A,s.onload=F,s.onerror=E,s.onprogress=function(){},s.onabort=function(){M=!0},s.ontimeout=E,s.open(R,O,!U,o.username,o.password),U||(s.withCredentials=!!o.withCredentials),!U&&o.timeout>0&&(I=setTimeout(function(){if(!M){M=!0,s.abort("timeout");var d=new Error("XMLHttpRequest timeout");d.code="ETIMEDOUT",E(d)}},o.timeout)),s.setRequestHeader)for(k in L)L.hasOwnProperty(k)&&s.setRequestHeader(k,L[k]);else if(o.headers&&!a(o.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in o&&(s.responseType=o.responseType),"beforeSend"in o&&typeof o.beforeSend=="function"&&o.beforeSend(s),s.send(_||null),s}function c(o){try{if(o.responseType==="document")return o.responseXML;var p=o.responseXML&&o.responseXML.documentElement.nodeName==="parsererror";if(o.responseType===""&&!p)return o.responseXML}catch{}return null}function g(){}return H.exports}var lr=fr();const jr=ir(lr);var Q="http://example.com",Vr=function(r,e){if(/^[a-z]+:/i.test(e))return e;/^data:/.test(r)&&(r=T.location&&T.location.href||"");var n=typeof T.URL=="function",t=/^\/\//.test(r),a=!T.location&&!/\/\//i.test(r);if(n?r=new T.URL(r,T.location||Q):/\/\//i.test(r)||(r=J.buildAbsoluteURL(T.location&&T.location.href||"",r)),n){var u=new URL(e,r);return a?u.href.slice(Q.length):t?u.href.slice(u.protocol.length):u.href}return J.buildAbsoluteURL(r,e)},$r=function(){function i(){this.listeners={}}var r=i.prototype;return r.on=function(n,t){this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(t)},r.off=function(n,t){if(!this.listeners[n])return!1;var a=this.listeners[n].indexOf(t);return this.listeners[n]=this.listeners[n].slice(0),this.listeners[n].splice(a,1),a>-1},r.trigger=function(n){var t=this.listeners[n];if(t)if(arguments.length===2)for(var a=t.length,u=0;u<a;++u)t[u].call(this,arguments[1]);else for(var f=Array.prototype.slice.call(arguments,1),v=t.length,c=0;c<v;++c)t[c].apply(this,f)},r.dispose=function(){this.listeners={}},r.pipe=function(n){this.on("data",function(t){n.push(t)})},i}(),vr=function(r){return T.atob?T.atob(r):Buffer.from(r,"base64").toString("binary")};function Jr(i){for(var r=vr(i),e=new Uint8Array(r.length),n=0;n<r.length;n++)e[n]=r.charCodeAt(n);return e}var y={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},sr=["video","audio","text"],Z=["Video","Audio","Text"],cr=function(r){return r&&r.replace(/avc1\.(\d+)\.(\d+)/i,function(e,n,t){var a=("00"+Number(n).toString(16)).slice(-2),u=("00"+Number(t).toString(16)).slice(-2);return"avc1."+a+"00"+u})},xr=function(r){r===void 0&&(r="");var e=r.split(","),n=[];return e.forEach(function(t){t=t.trim();var a;sr.forEach(function(u){var f=y[u].exec(t.toLowerCase());if(!(!f||f.length<=1)){a=u;var v=t.substring(0,f[1].length),c=t.replace(v,"");n.push({type:v,details:c,mediaType:u})}}),a||n.push({type:t,details:"",mediaType:"unknown"})}),n},Yr=function(r,e){if(!r.mediaGroups.AUDIO||!e)return null;var n=r.mediaGroups.AUDIO[e];if(!n)return null;for(var t in n){var a=n[t];if(a.default&&a.playlists)return xr(a.playlists[0].attributes.CODECS)}return null},pr=function(r){return r===void 0&&(r=""),y.audio.test(r.trim().toLowerCase())},hr=function(r){return r===void 0&&(r=""),y.text.test(r.trim().toLowerCase())},dr=function(r){if(!(!r||typeof r!="string")){var e=r.toLowerCase().split(",").map(function(a){return cr(a.trim())}),n="video";e.length===1&&pr(e[0])?n="audio":e.length===1&&hr(e[0])&&(n="application");var t="mp4";return e.every(function(a){return y.mp4.test(a)})?t="mp4":e.every(function(a){return y.webm.test(a)})?t="webm":e.every(function(a){return y.ogg.test(a)})&&(t="ogg"),n+"/"+t+';codecs="'+r+'"'}},Wr=function(r){return r===void 0&&(r=""),T.MediaSource&&T.MediaSource.isTypeSupported&&T.MediaSource.isTypeSupported(dr(r))||!1},Qr=function(r){return r===void 0&&(r=""),r.toLowerCase().split(",").every(function(e){e=e.trim();for(var n=0;n<Z.length;n++){var t=Z[n];if(y["muxer"+t].test(e))return!0}return!1})},Zr="mp4a.40.2",Kr="avc1.4d400d",mr=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,gr=/^application\/dash\+xml/i,br=function(r){return mr.test(r)?"hls":gr.test(r)?"dash":r==="application/vnd.videojs.vhs+json"?"vhs-json":null},Ar=function(r){return r.toString(2).length},wr=function(r){return Math.ceil(Ar(r)/8)},Tr=function(r){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer},Er=function(r){return Tr(r)},l=function(r){return r instanceof Uint8Array?r:(!Array.isArray(r)&&!Er(r)&&!(r instanceof ArrayBuffer)&&(typeof r!="number"||typeof r=="number"&&r!==r?r=0:r=[r]),new Uint8Array(r&&r.buffer||r,r&&r.byteOffset||0,r&&r.byteLength||0))},m=T.BigInt||Number,G=[m("0x1"),m("0x100"),m("0x10000"),m("0x1000000"),m("0x100000000"),m("0x10000000000"),m("0x1000000000000"),m("0x100000000000000"),m("0x10000000000000000")];(function(){var i=new Uint16Array([65484]),r=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);return r[0]===255?"big":r[0]===204?"little":"unknown"})();var Lr=function(r,e){var n=e===void 0?{}:e,t=n.signed,a=t===void 0?!1:t,u=n.le,f=u===void 0?!1:u;r=l(r);var v=f?"reduce":"reduceRight",c=r[v]?r[v]:Array.prototype[v],g=c.call(r,function(p,x,A){var D=f?A:Math.abs(A+1-r.length);return p+m(x)*G[D]},m(0));if(a){var o=G[r.length]/m(2)-m(1);g=m(g),g>o&&(g-=o,g-=o,g-=m(2))}return Number(g)},Cr=function(r,e){var n={},t=n.le,a=t===void 0?!1:t;(typeof r!="bigint"&&typeof r!="number"||typeof r=="number"&&r!==r)&&(r=0),r=m(r);for(var u=wr(r),f=new Uint8Array(new ArrayBuffer(u)),v=0;v<u;v++){var c=a?v:Math.abs(v+1-f.length);f[c]=Number(r/G[v]&m(255)),r<0&&(f[c]=Math.abs(~f[c]),f[c]-=v===0?1:2)}return f},yr=function(r,e){if(typeof r!="string"&&r&&typeof r.toString=="function"&&(r=r.toString()),typeof r!="string")return new Uint8Array;e||(r=unescape(encodeURIComponent(r)));for(var n=new Uint8Array(r.length),t=0;t<r.length;t++)n[t]=r.charCodeAt(t);return n},re=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];if(e=e.filter(function(f){return f&&(f.byteLength||f.length)&&typeof f!="string"}),e.length<=1)return l(e[0]);var t=e.reduce(function(f,v,c){return f+(v.byteLength||v.length)},0),a=new Uint8Array(t),u=0;return e.forEach(function(f){f=l(f),a.set(f,u),u+=f.byteLength}),a},h=function(r,e,n){var t=n===void 0?{}:n,a=t.offset,u=a===void 0?0:a,f=t.mask,v=f===void 0?[]:f;r=l(r),e=l(e);var c=e.every?e.every:Array.prototype.every;return e.length&&r.length-u>=e.length&&c.call(e,function(g,o){var p=v[o]?v[o]&r[u+o]:r[u+o];return g===p})},ee=function(r,e,n){e.forEach(function(t){for(var a in r.mediaGroups[t])for(var u in r.mediaGroups[t][a]){var f=r.mediaGroups[t][a][u];n(f,t,a,u)}})},Dr=l([73,68,51]),Fr=function(r,e){e===void 0&&(e=0),r=l(r);var n=r[e+5],t=r[e+6]<<21|r[e+7]<<14|r[e+8]<<7|r[e+9],a=(n&16)>>4;return a?t+20:t+10},N=function i(r,e){return e===void 0&&(e=0),r=l(r),r.length-e<10||!h(r,Dr,{offset:e})?e:(e+=Fr(r,e),i(r,e))},K=function(r){return typeof r=="string"?yr(r):r},Br=function(r){return Array.isArray(r)?r.map(function(e){return K(e)}):[K(r)]},Rr=function i(r,e,n){n===void 0&&(n=!1),e=Br(e),r=l(r);var t=[];if(!e.length)return t;for(var a=0;a<r.length;){var u=(r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3])>>>0,f=r.subarray(a+4,a+8);if(u===0)break;var v=a+u;if(v>r.length){if(n)break;v=r.length}var c=r.subarray(a+8,v);h(f,e[0])&&(e.length===1?t.push(c):t.push.apply(t,i(c,e.slice(1),n))),a=v}return t},X={EBML:l([26,69,223,163]),DocType:l([66,130]),Segment:l([24,83,128,103]),SegmentInfo:l([21,73,169,102]),Tracks:l([22,84,174,107]),Track:l([174]),TrackNumber:l([215]),DefaultDuration:l([35,227,131]),TrackEntry:l([174]),TrackType:l([131]),FlagDefault:l([136]),CodecID:l([134]),CodecPrivate:l([99,162]),VideoTrack:l([224]),AudioTrack:l([225]),Cluster:l([31,67,182,117]),Timestamp:l([231]),TimestampScale:l([42,215,177]),BlockGroup:l([160]),BlockDuration:l([155]),Block:l([161]),SimpleBlock:l([163])},z=[128,64,32,16,8,4,2,1],kr=function(r){for(var e=1,n=0;n<z.length&&!(r&z[n]);n++)e++;return e},q=function(r,e,n,t){n===void 0&&(n=!0),t===void 0&&(t=!1);var a=kr(r[e]),u=r.subarray(e,e+a);return n&&(u=Array.prototype.slice.call(r,e,e+a),u[0]^=z[a-1]),{length:a,value:Lr(u,{signed:t}),bytes:u}},b=function i(r){return typeof r=="string"?r.match(/.{1,2}/g).map(function(e){return i(e)}):typeof r=="number"?Cr(r):r},Mr=function(r){return Array.isArray(r)?r.map(function(e){return b(e)}):[b(r)]},Sr=function i(r,e,n){if(n>=e.length)return e.length;var t=q(e,n,!1);if(h(r.bytes,t.bytes))return n;var a=q(e,n+t.length);return i(r,e,n+a.length+a.value+t.length)},rr=function i(r,e){e=Mr(e),r=l(r);var n=[];if(!e.length)return n;for(var t=0;t<r.length;){var a=q(r,t,!1),u=q(r,t+a.length),f=t+a.length+u.length;u.value===127&&(u.value=Sr(a,r,f),u.value!==r.length&&(u.value-=f));var v=f+u.value>r.length?r.length:f+u.value,c=r.subarray(f,v);h(e[0],a.bytes)&&(e.length===1?n.push(c):n=n.concat(i(c,e.slice(1))));var g=a.length+u.length+c.length;t+=g}return n},Hr=l([0,0,0,1]),Nr=l([0,0,1]),Xr=l([0,0,3]),qr=function(r){for(var e=[],n=1;n<r.length-2;)h(r.subarray(n,n+3),Xr)&&(e.push(n+2),n++),n++;if(e.length===0)return r;var t=r.length-e.length,a=new Uint8Array(t),u=0;for(n=0;n<t;u++,n++)u===e[0]&&(u++,e.shift()),a[n]=r[u];return a},nr=function(r,e,n,t){r=l(r),n=[].concat(n);for(var a=0,u,f=0;a<r.length&&(f<t||u);){var v=void 0;if(h(r.subarray(a),Hr)?v=4:h(r.subarray(a),Nr)&&(v=3),!v){a++;continue}if(f++,u)return qr(r.subarray(u,a));var c=void 0;e==="h264"?c=r[a+v]&31:e==="h265"&&(c=r[a+v]>>1&63),n.indexOf(c)!==-1&&(u=a+v),a+=v+(e==="h264"?1:2)}return r.subarray(0,0)},Or=function(r,e,n){return nr(r,"h264",e,n)},_r=function(r,e,n){return nr(r,"h265",e,n)},w={webm:l([119,101,98,109]),matroska:l([109,97,116,114,111,115,107,97]),flac:l([102,76,97,67]),ogg:l([79,103,103,83]),ac3:l([11,119]),riff:l([82,73,70,70]),avi:l([65,86,73]),wav:l([87,65,86,69]),"3gp":l([102,116,121,112,51,103]),mp4:l([102,116,121,112]),fmp4:l([115,116,121,112]),mov:l([102,116,121,112,113,116]),moov:l([109,111,111,118]),moof:l([109,111,111,102])},B={aac:function(r){var e=N(r);return h(r,[255,16],{offset:e,mask:[255,22]})},mp3:function(r){var e=N(r);return h(r,[255,2],{offset:e,mask:[255,6]})},webm:function(r){var e=rr(r,[X.EBML,X.DocType])[0];return h(e,w.webm)},mkv:function(r){var e=rr(r,[X.EBML,X.DocType])[0];return h(e,w.matroska)},mp4:function(r){if(B["3gp"](r)||B.mov(r))return!1;if(h(r,w.mp4,{offset:4})||h(r,w.fmp4,{offset:4})||h(r,w.moof,{offset:4})||h(r,w.moov,{offset:4}))return!0},mov:function(r){return h(r,w.mov,{offset:4})},"3gp":function(r){return h(r,w["3gp"],{offset:4})},ac3:function(r){var e=N(r);return h(r,w.ac3,{offset:e})},ts:function(r){if(r.length<189&&r.length>=1)return r[0]===71;for(var e=0;e+188<r.length&&e<188;){if(r[e]===71&&r[e+188]===71)return!0;e+=1}return!1},flac:function(r){var e=N(r);return h(r,w.flac,{offset:e})},ogg:function(r){return h(r,w.ogg)},avi:function(r){return h(r,w.riff)&&h(r,w.avi,{offset:8})},wav:function(r){return h(r,w.riff)&&h(r,w.wav,{offset:8})},h264:function(r){return Or(r,7,3).length},h265:function(r){return _r(r,[32,33],3).length}},j=Object.keys(B).filter(function(i){return i!=="ts"&&i!=="h264"&&i!=="h265"}).concat(["ts","h264","h265"]);j.forEach(function(i){var r=B[i];B[i]=function(e){return r(l(e))}});var Ur=B,ne=function(r){r=l(r);for(var e=0;e<j.length;e++){var n=j[e];if(Ur[n](r))return n}return""},te=function(r){return Rr(r,["moof"]).length>0};export{Kr as D,$r as S,jr as X,Zr as a,Wr as b,Yr as c,Jr as d,Tr as e,ee as f,dr as g,ne as h,pr as i,re as j,yr as k,N as l,Qr as m,te as n,l as o,xr as p,Vr as r,br as s,cr as t};
